---
title: 'Get started with Kubernetes'
tags:
  - Integrations
  - Kubernetes integration
  - Installation
translate:
  - jp
  - kr
metaDescription: "New Relic's Kubernetes integration: How to install and activate the integration, and what data is reported."
redirects:
  - /docs/integrations/kubernetes-integration/installation/kubernetes-integration-install-configure
  - /docs/kubernetes-monitoring-integration-beta
  - /docs/kubernetes-integration-beta
  - /docs/kubernetes-integration
  - /docs/kubernetes-integration-new-relic-infrastructure
  - /docs/kubernetes-monitoring-integration
  - /docs/integrations/host-integrations/host-integrations-list/kubernetes-monitoring-integration
  - /docs/integrations/kubernetes-integration/installation/kubernetes-monitoring-integration
  - /docs/integrations/kubernetes-integration/installation/kubernetes-monitoring-installation
  - /docs/integrations/kubernetes-integration/installation/kubernetes-installation-configuration
  - /docs/integrations/kubernetes-integration/installation
signupBanner:
  text: Monitor and improve your entire stack. 100GB free. Forever.
---

import kubernetesPivotal from 'images/kubernetes_logo_pivotal.png'

import kubernetesAks from 'images/kubernetes_logo_aks.png'

import kubernetesOpenshift from 'images/kubernetes_logo_openshift.png'

import kubernetesCke from 'images/kubernetes_logo_cke.png'

import kubernetesEks from 'images/kubernetes_logo_eks.png'

import pixieLiveDebugging from 'images/pixie_screenshot-full_live-debugging.png'

import pixieServiceOtelMap from 'images/pixie_screenshot-full_service-otel-map.png'

The New Relic Kubernetes integration gives you full observability into the health and performance of your environment by leveraging the New Relic infrastructure agent. This agent collects metrics from your cluster alongside various other New Relic integrations such as the [Kubernetes events integration](/docs/integrations/kubernetes-integration/kubernetes-events/install-kubernetes-events-integration), the [Prometheus Agent](/docs/infrastructure/prometheus-integrations/install-configure-prometheus-agent/install-prometheus-agent/), and the [New Relic log plugin](/docs/logs).


## Installing the Kubernetes Integration [#kubernetes-installation] 

You can choose to install the Kubernetes Integration with or without the New Relic Kubernetes Quickstart. This quickstart will install pre-built resources such as dashboards and alerts alongside the Kubernetes integration so that you can gain instant visibility into your Kubernetes clusters and workloads but is not a requirement for installing the Kubernetes Integration.

* [Only install the Kubernetes Integration](https://one.newrelic.com/nr1-core?state=51fbbd48-c8ca-ead9-bb90-af96e18d82a7)
* Install the Kubernetes Integration with the [New Relic Kubernetes quickstart](https://newrelic.com/instant-observability/kubernetes).

Once you’ve decided, follow the instructions below to navigate the Kubernetes Integration guided install. 


### Guided install [#installer]

We encourage you to use our guided install for servers, VMs, and [unprivileged](/docs/infrastructure/install-infrastructure-agent/linux-installation/linux-agent-running-modes) environments. The guided install can provide you either a Helm command with the required values filled, or a plain manifest if you don't want to use Helm. It also offers control over which features are enabled and which data is collected. If you are installing our integration on a managed cloud, please take a look at these [preliminary notes](#cloud-platforms) before proceeding.

Before you start the guided install, make sure you have a New Relic account. It's free and no credit card is required.

If your New Relic account [is in the EU region](/docs/using-new-relic/welcome-new-relic/get-started/our-eu-us-region-data-centers), choose the EU install option.

<ButtonGroup>
  <ButtonLink
    data-tessen="stitchedPathLinkClick"
    role="button"
    to="https://newrelic.com/signup"
    variant="primary"
  >
    Get an account
  </ButtonLink>

  <ButtonLink
    role="button"
    to="https://one.newrelic.com/launcher/k8s-cluster-explorer-nerdlet.cluster-explorer-launcher?pane=eyJuZXJkbGV0SWQiOiJpbnN0YWxsLW5ld3JlbGljLmhvbWUiLCJwYXRoIjoiZ3VpZGVkIiwiZW52Ijoia3ViZXJuZXRlcyIsImFjdGl2ZUVudmlyb25tZW50IjogImt1YmVybmV0ZXMifQ=="
    variant="primary"
  >
    Guided install
  </ButtonLink>
</ButtonGroup>

If custom manifests have been used instead of Helm, you will need to first remove the old installation using `kubectl delete -f previous-manifest-file.yml`, and then proceed through the guided installer again. This will generate an updated set of manifests that can be deployed using `kubectl apply -f manifest-file.yml`.


### Navigating the Kubernetes Integration guided install [#kubernetes-install-navigation] 

<Callout variant="important">
Make sure you are using the supported Kubernetes versions and make sure to check out the preliminary notes for your managed services or platforms on our [compatibility and requirements page](/docs/kubernetes-pixie/kubernetes-integration/get-started/kubernetes-integration-compatibility-requirements).
</Callout>

#### Configure the Kubernetes Integration [#configure-kubernetes-integration] 

**We'll send your data to this account**

Choose the New Relic account that you want your Kubernetes data written to. 

**Cluster name** 

Cluster name is the name we will use to tag your Kubernetes data with so that you can filter for the data specific to the cluster you’re installing this integration in. This is important if you choose to connect multiple clusters to your New Relic account so choose a name that you’ll recognize! 

**Namespace for the integration**

Namespace for the integration is the namespace we will use to house the Kubernetes integration in your cluster. We recommend using the default namespace of ‘newrelic’. 

#### Select the additional data you want to gather [#selecting-additional-data-kubernetes-integration] 

##### Scrape Prometheus Endpoints [#scraping-prometheus-endpoints] 

By selecting this option, we will install Prometheus in agent mode to collect metrics from the Prometheus endpoints exposed in your cluster. 

###### Scrape all Prometheus endpoints except core Kubernetes system metrics [#scrape-all-except-ksm] 

The first, and for most users, the recommended configuration, is to `Scrape all Prometheus endpoints except core Kubernetes system metrics`. We recommend this configuration because various other components of the Kubernetes integration, such as [`kube-state-metrics`, `newrelic-infrastructure`, and `nri-prometheus`](https://github.com/newrelic/helm-charts/tree/master/charts/nri-bundle#bundled-charts) will already collect these metrics and configuring Prometheus to exclude those metrics will save your data ingest costs by removing any metric redundancies. 

This configuration will filter out any metrics prefixed with [`kube_`, `container_`, `machine_`, and `cadvisor_`](https://github.com/newrelic/newrelic-prometheus-configurator/blob/64af9453f4b20d4aab88a4d1afda55cf9a6e63c4/charts/newrelic-prometheus-agent/static/lowdatamodedefaults.yaml).


```
low_data_mode:
- action: drop
  source_labels: [__name__]
  regex: "kube_.+|container_.+|machine_.+|cadvisor_.+"
```
Above code snipped from: newrelic-prometheus-configurator/charts/newrelic-prometheus-agent/static/lowdatamodedefaults.yaml

###### Scrape all Prometheus endpoints [#scrape-all-endpoints] 

Some users may elect to `Scrape all Prometheus endpoints` regardless of any metric redundancies because they prefer to preserve Prometheus’ metric naming conventions across all Prometheus metrics.

###### Scrape only Prometheus endpoints with quickstarts [#scrape-only-quickstarts] 

New Relic provides [quickstarts](https://newrelic.com/instant-observability/?category=prometheus&search=), which are pre-made dashboards, alerts, and entities for various services. Some users may opt to have Prometheus only scrape for [services which have a pre-made quickstart](https://github.com/newrelic/newrelic-prometheus-configurator/blob/main/charts/newrelic-prometheus-agent/values.yaml#L214-L228) and are ready to go for instant observability. 


```
 kubernetes:
    # NewRelic provides a list of Dashboards, alerts and entities for several Services. The integrations_filter configuration
    # allows to scrape only the targets having this experience out of the box.
    # If integrations_filter is enabled, then the jobs scrape merely the targets having one of the specified labels matching
    # one of the values of app_values.
    # Under the hood, a relabel_configs with 'action=keep' are generated, consider it in case any custom extra_relabel_config is needed.
    integrations_filter:
      # -- enabling the integration filters, merely the targets having one of the specified labels matching
      #    one of the values of app_values are scraped. Each job configuration can override this default.
      enabled: true
      # -- source_labels used to fetch label values in the relabel config added by the integration filters configuration
      source_labels: ["app.kubernetes.io/name", "app.newrelic.io/name", "k8s-app"]
      # -- app_values used to create the regex used in the relabel config added by the integration filters configuration.
      # Note that a single regex will be created from this list, example: '.*(?i)(app1|app2|app3).*'
      app_values: ["redis", "traefik", "calico", "nginx", "coredns", "kube-dns", "etcd", "cockroachdb", "velero", "harbor", "argocd"]
```
Above code snipped from: newrelic-prometheus-configurator/charts/newrelic-prometheus-agent/values.yaml

###### Scrape only the following labels [#custom-app-labels]

Advanced users who have a good idea of what services they want to see Prometheus metrics from will find this option useful. Enter a comma-separated list of services you wish for Prometheus to scrape, and Prometheus will perform a wildcard match on the service name in order to find you metrics from your desired endpoint. This option will *only* provide metrics from the services that match the submitted list so be careful to validate the entry for correctness.

[Learn more about custom app labels here.](https://docs.newrelic.com/docs/infrastructure/prometheus-integrations/install-configure-prometheus-agent/advanced-configuration/#enable-disable-integrations)

The services you add to the submitted list will overwrite the data in `app_values` below and Prometheus will **only** scrape metrics from those services. 
```
  kubernetes:
    # NewRelic provides a list of Dashboards, alerts and entities for several Services. The integrations_filter configuration
    # allows to scrape only the targets having this experience out of the box.
    # If integrations_filter is enabled, then the jobs scrape merely the targets having one of the specified labels matching
    # one of the values of app_values.
    # Under the hood, a relabel_configs with 'action=keep' are generated, consider it in case any custom extra_relabel_config is needed.
    integrations_filter:
      # -- enabling the integration filters, merely the targets having one of the specified labels matching
      #    one of the values of app_values are scraped. Each job configuration can override this default.
      enabled: true
      # -- source_labels used to fetch label values in the relabel config added by the integration filters configuration
      source_labels: ["app.kubernetes.io/name", "app.newrelic.io/name", "k8s-app"]
      # -- app_values used to create the regex used in the relabel config added by the integration filters configuration.
      # Note that a single regex will be created from this list, example: '.*(?i)(app1|app2|app3).*'
      app_values: ["redis", "traefik", "calico", "nginx", "coredns", "kube-dns", "etcd", "cockroachdb", "velero", "harbor", "argocd"]
```
Above code snipped from: newrelic-prometheus-configurator/charts/newrelic-prometheus-agent/values.yaml

##### Gather log data [#gather-logs]

Users who wish to prioritize data ingest costs may choose to gather log data with minimal enrichment, which [drops Labels and Annotations](https://source.datanerd.us/fsi/k8s-config-generator/blob/master/deploy/helm/nri-bundle/charts/newrelic-logging/values.yaml#L106-L108) from their logs and only shares standard Kubernetes log data such as the [name of the cluster, container, namespace, and pod along with the message and timestamp](https://source.datanerd.us/fsi/k8s-config-generator/blob/master/deploy/helm/nri-bundle/charts/newrelic-logging/values.yaml#L116-L125).

In minimal enrichment, only the following fields are retained:

```
Allowlist_key  container_name
Allowlist_key  namespace_name
Allowlist_key  pod_name
Allowlist_key  stream
Allowlist_key  log
```

Conversely, users who prefer more robust data can opt to fully enrich their logs by adding in label and annotation data to their log data. 

**Full Enrichment Log Data** 

```
[
  {
    "cluster_name": "api-test",
    "kubernetes": {
      "annotations": {
        "kubernetes.io/psp": "eks.privileged"
      },
      "container_hash": "fryckbos/test@sha256:5b098eaf3c7d5b3585eb10cebee63665b6208bea31ef31a3f0856c5ffdda644b",
      "container_image": "fryckbos/test:latest",
      "container_name": "newrelic-logging",
      "docker_id": "134e1daf63761baa15e035b08b7aea04518a0f0e50af4215131a50c6a379a072",
      "host": "ip-192-168-17-123.ec2.internal",
      "labels": {
        "app": "newrelic-logging",
        "app.kubernetes.io/name": "newrelic-logging",
        "controller-revision-hash": "84db95db86",
        "pod-template-generation": "1",
        "release": "nri-bundle"
      },
      "namespace_name": "nrlogs",
      "pod_id": "54556e3e-719c-46b5-af69-020b75d69bf1",
      "pod_name": "nri-bundle-newrelic-logging-jxnbj"
    },
    "message": "[2021/09/14 12:30:49] [ info] [engine] started (pid=1)\n",
    "plugin": {
      "source": "kubernetes",
      "type": "fluent-bit",
      "version": "1.8.1"
    },
    "stream": "stderr",
    "time": "2021-09-14T12:30:49.138824971Z",
    "timestamp": 1631622649138
  }
]
```

**Minimal Enrichment Log Data** 

```
[
  {
    "cluster_name": "api-test",
    "container_name": "newrelic-logging",
    "namespace_name": "nrlogs",
    "pod_name": "nri-bundle-newrelic-logging-jxnbj",
    "message": "[2021/09/14 12:30:49] [ info] [engine] started (pid=1)\n",
    "stream": "stderr",
    "timestamp": 1631622649138
  }
]
```


##### Enable service-level insights, full-body requests, and application profiles through Pixie [#enable-pixie]
[Pixie](https://docs.px.dev/about-pixie/what-is-pixie/) is an open source observability tool for Kubernetes applications that uses eBPF to automatically collect telemetry data. Users who do not have Pixie installed on their cluster but would like to leverage Pixie's powerful telemetry data collection and visualization on the [New Relic platform](https://docs.newrelic.com/docs/kubernetes-pixie/auto-telemetry-pixie/get-started-auto-telemetry-pixie/), can check `Enable service-level insights, full-body requests, and application profiles through Pixie` in the Kubernetes Integration installation flow for a quick and painless installation. 

###### Community Cloud hosted Pixie is already running on this cluster [#community-cloud-pixie] 

[Pixie can be hosted in various ways](https://docs.px.dev/installing-pixie/install-guides/#title). New Relic provides a different level of integration support for each Pixie hosting option. 


**Community Cloud Pixie**
Users who already have Pixie installed on their Kubernetes cluster and are leveraging Pixie’s Community Cloud rather than self-hosting the Pixie Cloud can provide an API key to embed Pixie’s live UI into their New Relic account for easy access to Pixie's Live Debugging tool as well as write their Pixie data into New Relic through the New Relic OpenTelemetry endpoint. 

<img
  title="service graph in live debugger"
  alt="service-graph"
  src={pixieLiveDebugging}
/>

**Self-Hosted Pixie**
Unfortunately New Relic does not support embedding Pixie’s Live UI for users who are self-hosting their Pixie Cloud, however, the Kubernetes integration can still enable the export of Pixie telemetry data into New Relic via the OpenTelemetry endpoint for long-term data retention and visibility. 

For users who are self-hosting their Pixie integration and would like to enable the export of Pixie telemetry data into New Relic, simply enable Pixie in the Kubernetes Integration without checking the `Community Cloud hosted Pixie option` and the Kubernetes Integration will detect that Pixie is running in the user’s cluster and enable the data export for instant data visibility and insight.

<img
  title="The OpenTelemetry **Service map** view shows helps visualize your application's dependencies."
  alt="The OpenTelemetry **Service map** view shows helps visualize your application's dependencies."
  src={pixieServiceOtelMap}
/>



### Preliminary notes for your managed services or platforms [#cloud-platforms]

Before starting our [guided install](https://one.newrelic.com/nr1-core?state=51fbbd48-c8ca-ead9-bb90-af96e18d82a7), check out these notes for your managed services or platforms:

<CollapserGroup>
  <Collapser
    className="freq-link"
    id="install-amazon-eks"
    title={<><img src={kubernetesEks} alt="EKS" style={{ verticalAlign: 'middle' }}/>Amazon EKS / EKS Anywhere / EKS Anywhere on bare metal</>}
  >
    The Kubernetes integration only monitors worker nodes into Amazon EKS as Amazon abstracts the management of master nodes away from the Kubernetes platform.

    Before using our [guided install](https://one.newrelic.com/nr1-core?state=51fbbd48-c8ca-ead9-bb90-af96e18d82a7) to deploy the Kubernetes integration in Amazon EKS,  make sure to install `eksctl`, the [command line tool](https://docs.aws.amazon.com/eks/latest/userguide/eksctl.html) for managing Kubernetes clusters on Amazon EKS.
  </Collapser>

  <Collapser
    className="freq-link"
    id="install-amazon-eks-fargate"
    title={<><img src={kubernetesEks} alt="EKS" style={{ verticalAlign: 'middle' }}/>Amazon EKS Fargate</>}
  >
    Installation on EKS Fargate clusters requires dedicated steps, which are detailed in our [EKS Fargate installation docs](/docs/integrations/kubernetes-integration/installation/install-fargate-integration).
  </Collapser>

  <Collapser
    className="freq-link"
    id="install-google-kubernetes-engine"
    title={<><img src={kubernetesCke} alt="CKE" style={{ verticalAlign: 'middle' }}/>Google Kubernetes Engine (GKE)</>}
  >
    The Kubernetes integration only monitors worker nodes in GKE as Google abstracts the management of master nodes away from the Kubernetes platform.
    
    Before starting our [guided install](https://one.newrelic.com/nr1-core?state=51fbbd48-c8ca-ead9-bb90-af96e18d82a7) to deploy the Kubernetes integration on GKE, ensure you have sufficient permissions:

    1. Go to [console.cloud.google.com/iam-admin/iam](https://console.cloud.google.com/iam-admin/iam) and find your username. 
    2. Click **edit**.
    3. Ensure you have permissions to create `Roles` and `ClusterRoles`: If you are not sure, add the **Kubernetes Engine Cluster Admin** role. If you cannot edit your user role, ask the owner of the GCP project to give you the necessary permissions.
  </Collapser>

  <Collapser
    className="freq-link"
    id="install-openshift-container-platform"
    title={<><img src={kubernetesOpenshift} alt="OpenShift" style={{ verticalAlign: 'middle' }}/> OpenShift container platform</>}
  >
    To deploy the Kubernetes integration with [OpenShift](https://learn.openshift.com):

    1. Add the service accounts used by the integration to your privileged [Security Context Constraints](https://docs.openshift.com/enterprise/3.0/admin_guide/manage_scc.html):

       ```
       oc adm policy add-scc-to-user privileged system:serviceaccount:<namespace>:<release_name>-newrelic-infrastructure
       oc adm policy add-scc-to-user privileged system:serviceaccount:<namespace>:<release_name>-newrelic-infrastructure-controlplane
       oc adm policy add-scc-to-user privileged system:serviceaccount:<namespace>:<release_name>-kube-state-metrics
       oc adm policy add-scc-to-user privileged system:serviceaccount:<namespace>:<release_name>-newrelic-logging
       oc adm policy add-scc-to-user privileged system:serviceaccount:<namespace>:<release_name>-nri-kube-events
       oc adm policy add-scc-to-user privileged system:serviceaccount:<namespace>:<release_name>-nri-metadata-injection-admission
       oc adm policy add-scc-to-user privileged system:serviceaccount:<namespace>:<release_name>-nrk8s-controlplane
       oc adm policy add-scc-to-user privileged system:serviceaccount:<namespace>:default
       ```
       
       <Callout variant="tip">
        The default `release_name` provided by the installer is `newrelic-bundle`. The default `namespace` is `newrelic`.
       </Callout>
       
    2. Complete the steps in our [guided install](https://one.newrelic.com/nr1-core?state=51fbbd48-c8ca-ead9-bb90-af96e18d82a7).
    3. If you're using signed certificates, make sure they are properly configured by using the following variables in the `DaemonSet` portion of your manifest, to set the `.pem` file:
      ```yaml
      env:
        - name: NRIA_CA_BUNDLE_DIR
          value: YOUR_CA_BUNDLE_DIR
        - name: NRIA_CA_BUNDLE_FILE
          value: YOUR_CA_BUNDLE_NAME
      ```
    4. Set your YAML key path to `spec.template.spec.containers.name.env`. 
    5. Save your changes.

  </Collapser>

  <Collapser
    className="freq-link"
    id="install-azure-aks"
    title={<><img src={kubernetesAks} alt="AKS" style={{ verticalAlign: 'middle' }}/> Azure Kubernetes Service (AKS)</>}
  >
    The Kubernetes integration only monitors worker nodes in the Azure Kubernetes Service as Azure abstracts the management of master nodes away from the Kubernetes platform.

  </Collapser>
  
</CollapserGroup>

<InstallFeedback />

## Use your Kubernetes data

Learn more about:

* [Unprivileged and privileged modes](/docs/infrastructure/install-infrastructure-agent/linux-installation/linux-agent-running-modes)
* [Exploring your Kubernetes data in the UI](/docs/kubernetes-pixie/kubernetes-integration/understand-use-data/kubernetes-cluster-explorer)
* [Using your Kubernetes data](/docs/kubernetes-pixie/kubernetes-integration/understand-use-data/find-use-your-kubernetes-data) with queries, in charts, for alerts, etc.
