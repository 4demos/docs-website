---
title: Differences between Prometheus OpenMetrics and the Prometheus agent
tags:
  - Integrations
  - Prometheus integrations
  - Install and configure OpenMetrics
metaDescription: Migration guidelines to move from Prometheus OpenMetrics to New Relic Prometheus Agent.
---

If you're using our [Prometheus OpenMetrics integration](/docs/infrastructure/prometheus-integrations/install-configure-openmetrics/install-update-or-uninstall-your-prometheus-openmetrics-integration), `nri-prometheus`, you can migrate to [New Relic's Prometheus agent](/docs/infrastructure/prometheus-integrations/install-configure-prometheus-agent/install-prometheus-agent), `newrelic-prometheus-agent`, to achieve the same monitoring experience.

Since the `newrelic-prometheus-agent` is actually running the `Prometheus server` in agent mode, the configuration file structure has changed to offer more flexibility and the possibility to use any scrape related feature of the Prometheus server, such as authorization methods and relabel configuration setups.

We translate our simplified configuration file to a prometheus server configuration file, to give you an easier configuration experience. We suggest that you read the documentation on the `newrelic-prometheus-agent` configuration options, since this document focuses on the differences between Prometheus OpenMetrics and the Prometheus agent.

## Metadata [#metadata]

<Callout variant="tip">
  Read the full list list of labels added by the Prometheus agent (`newrelic-prometheus-agent`), [here](/docs/infrastructure/prometheus-integrations/install-configure-prometheus-agent/default-metrics-and-metric-attributes#metric-labels).
</Callout>

The following table highlights the metadata changes between `nri-prometheus` and `newrelic-prometheus-agent`:

<table>
  <thead>
    <tr>
      <th style={{ width: "280px" }}>
        nri-prometheus
      </th>

      <th style={{ width: "300px" }}>
        newrelic-prometheus-agent
      </th>

      <th>
        Change
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `namespaceName`
      </td>

      <td>
        `namespace`
      </td>

      <td>
        Renamed
      </td>
    </tr>

    <tr>
      <td>
        `nodeName`
      </td>

      <td>
        `node`
      </td>

      <td>
        Renamed
      </td>
    </tr>

    <tr>
      <td>
        `podName`
      </td>

      <td>
        `pod`
      </td>

      <td>
        Renamed
      </td>
    </tr>

    <tr>
      <td>
        `serviceName`
      </td>

      <td>
        `service`
      </td>

      <td>
        Renamed
      </td>
    </tr>

    <tr>
      <td>
        `deploymentName`
      </td>

      <td>
        `-`
      </td>

      <td>
        Removed
      </td>
    </tr>

    <tr>
      <td>
        `clusterName`
      </td>

      <td>
        `cluster_name`
      </td>

      <td>
        Renamed
      </td>
    </tr>

    <tr>
      <td>
        `integrationName`
      </td>

      <td>
        `-`
      </td>

      <td>
        Removed
      </td>
    </tr>

    <tr>
      <td>
        `integrationVersion`
      </td>

      <td>
        `-`
      </td>

      <td>
        Removed
      </td>
    </tr>

    <tr>
      <td>
        `metricName`
      </td>

      <td>
        `-`
      </td>

      <td>
        Removed
      </td>
    </tr>

    <tr>
      <td>
        `nrMetricType`
      </td>

      <td>
        `-`
      </td>

      <td>
        Removed
      </td>
    </tr>

    <tr>
      <td>
        `promMetricType`
      </td>

      <td>
        `-`
      </td>

      <td>
        Removed
      </td>
    </tr>

    <tr>
      <td>
        `label.kubernetesLabel`
      </td>

      <td>
        `kubernetesLabel`
      </td>

      <td>
        Renamed<br/>The `label.` prefix has been removed, and the label name modified to comply with Prometheus' naming standards.
      </td>
    </tr>

    <tr>
      <td>
        `targetName`
      </td>

      <td>
        `-`
      </td>

      <td>
        Removed
      </td>
    </tr>

    <tr>
      <td>
        `scrapedTargetKind`
      </td>

      <td>
        `job`
      </td>

      <td>
        Renamed<br/>The job can be used to identify the scrape kind.
      </td>
    </tr>

    <tr>
      <td>
        `scrapedTargetName`
      </td>

      <td>
        `-`
      </td>

      <td>
        Removed
      </td>
    </tr>

    <tr>
      <td>
        `scrapedTargetName`
      </td>

      <td>
        `instance`
      </td>

      <td>
        Renamed<br/>`instance` contains the `host:port` for the target.
      </td>
    </tr>
  </tbody>
</table>

## Kubernetes target discovery [#K8s-target-discovery]

We've improved the target discovery configuration by adding `Jobs`. See how to [configure Kubernetes target discovery](/docs/infrastructure/prometheus-integrations/install-configure-prometheus-agent/setup-prometheus-agent#k8-target-discovery).

Default behaviors have changed between Prometheus OpenMetrics and the Prometheus agent. While, by default, Prometheus OpenMetrics scrapes pods and services containing `prometheus.io/scrape=true` as a label or annotation, the Prometheus agent scrapes pods and endpoints from services containing `prometheus.io/scrape=true` as an **annotation only**.

Node metrics are no longer scraped by default in the Prometheus agent, as it may cause metric duplication since it's normally used by New Relic's kubernetes integration.

## Metric types [#metric-types]

Prometheus OpenMetrics, `nri-prometheus`, as a custom solution, converts Prometheus metrics to New Relic metrics before sending them, by applying [mappings](/docs/infrastructure/prometheus-integrations/view-query-data/translate-promql-queries-nrql#compare) according to the metric metadata type reading from the scraped data: `# TYPE <metric_type>`.

On the Prometheus agent, `newrelic-prometheus-agent`, which leverages a standard Prometheus server, metrics are sent directly to the New Relic's remote write endpoint, which handles this conversion based on metric names. Some metrics may not be properly converted by the remote write endpoint:

- Prometheus Counter metrics **without** the name suffix `total`, `count`, `sum`, or `bucket` will be converted as **Gauge**.
- Prometheus Gauge metrics **with** the name suffix `total`, `count`, `sum`, or `bucket` will be converted as **Counter**.

To fix this, you can set up metric type mappings relabel options.

## Transformations [#transformations]

Prometheus OpenMetrics, `nri-prometheus`, transformations are now replaced with Prometheus relabel configurations. See a list of [examples of relabel configuration setups](/docs/infrastructure/prometheus-integrations/install-configure-prometheus-agent/setup-prometheus-agent#metric-label-transformations).

## Self-instrumentation [#self-instrumentation]

Similar to Prometheus OpenMetrics (`nri-prometheus`), the Prometheus agent (`newrelic-prometheus-agent`) self-scrapes internal metrics. These metrics have the `prometheus_` prefix and you can use them to observe the status of the Prometheus instance. By default, only a reduced set of these metrics are sent. You can find the list of metrics on the [default values.yaml file](https://github.com/newrelic/newrelic-prometheus-configurator/blob/main/charts/newrelic-prometheus-agent/values.yaml) of the chart, by searching for `job_name: self-metrics`.

We also give you a curated dashboard for self-metrics with performance and health information, and also metrics volume sent. Install the quickstart containing the [dashboard for the Prometheus agent](https://newrelic.com/instant-observability/prometheus-agent) in your New Relic account.
