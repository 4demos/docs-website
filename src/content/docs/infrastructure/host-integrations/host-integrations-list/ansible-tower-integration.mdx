---
title: Get metrics from Ansible Tower
tags:
  - Integrations
  - Prometheus integrations
  - Install and configure remote write
  - Ansible Tower
  - Ansible Tower quickstart
metaDescription: The New Relic Ansible Tower quickstart sends data scraped by your Prometheus integration to the New Relic platform.
---

import accessDashboards from 'images/Access_dashboards.png'

import ansibleLogsQuery from 'images/ansibleLogsQuery.png'

import ansibleQueryMetrics from 'images/ansibleQueryMetrics.png'

import ansibleDashLanding from 'images/ansibleDashLanding.png'

import ansibleViewQuery from 'images/ansibleViewQuery.gif'

Our Ansible Tower integration takes performance data about your Ansible Tower projects and transforms them into pre-built, customizable dashboards.  Track the statuses of your jobs, view your Ansible Tower logs, or see weekly comparisons of your average host load.

<img
  title="Ansible Tower dashboard landing page"
  alt="A screenshot of a dashboard with Ansible Tower metrics. The dashboard has 3 different flags for successful, failed, and erroring jobs. There is a line graph that compares pending jobs against running jobs."
  src={ansibleDashLanding}
/>
<figcaption>
After setting up Ansible Tower with New Relic, your data will display in this quickstart dashboard. 
</figcaption> 

## Set up Prometheus and the infrastructure agent [#setup]

Before you can monitor your Ansible Tower projects with New Relic, you need to:

1. Confirm that you've set up Prometheus to scrape data from Ansible Tower. You can learn more about this process at [Ansible Tower's docs site](https://docs.ansible.com/ansible-tower/latest/html/administration/metrics.html).
2. Install our infrastructure agent for Linux systems. This enables log forwarding so your project logs appear in your custom dashboards. We recommend using our [guided install](https://one.newrelic.com/marketplace?account=1&state=9fc6e1c7-1ffb-1ff0-862d-1ea1ed4a1c31), or if the command line is more your style, you can also [install via package manager](/docs/infrastructure/install-infrastructure-agent/linux-installation/install-infrastructure-monitoring-agent-linux).

## Get Ansible Tower metrics in a dashboard [#dash]

Our Ansible Tower integration builds atop our Prometheus remote write integration, where you use your own Prometheus server. To view your data in our quickstart dashboard, follow the below steps to integrate Ansible Tower, Prometheus, and the New Relic platform. 

<img
  title="Access_dashboards.png"
  alt="A screenshot that identifies where to find the Dashboards tab in the top nav."
  src={accessDashboards}
/>
<figcaption>
**[one.newrelic.com](https://one.newrelic.com)** > Hover to the top nav > Click **Dashboards**: After installation, you can find your dashboards in the New Relic platform. 
</figcaption> 

<CollapserGroup>
<Collapser
    id="logging"
    title="Step 1. Connect Ansible Tower logs to the infrastructure agent"
  >
Navigate `/etc/newrelic-infra/logging.d/`. If you don't see a `logging.yml` file, then create one.

Add this snippet to the `logging.yml` file:

```yml
- name: ansible-tower.log
  file: /var/log/tower/tower.log
  attributes:
    logtype: ansible_tower_log
```
</Collapser>
<Collapser
  id="integrate"
  title="Step 2. Integrate Prometheus in the New Relic platform"
  >
In the `prometheus.yml` file, add this snippet:

```yml
remote_write:
  - url: "YOUR URL"
    bearer_token: "YOUR TOKEN"
scrape_configs:
  - job_name: "prometheus"
  static_configs:
    - targets: ["localhost:9100"]
```

This snippet: 

* Connects Prometheus to the New Relic platform via `remote_write`. 
* Sets `"prometheus"` as the target so it can scrape data from itself.
</Collapser>
<Collapser
  id="jobs"
  title="Step 3. Grab Ansible Tower metrics"
>

With data from Prometheus exposed to New Relic, you can now integrate your Ansible Tower projects into the New Relic platform. 

Add this snippet to that same  `prometheus.yml` file: 

  ```yml
- job_name: "tower"
    tls_config: 
      insecure_skip_verify: true
    metrics_path: /api/v2/metrics
    scrape_interval: 5s
    scheme: https
    bearer_token: "YOUR_TOKEN"
    static_configs: 
      - targets:  ["localhost:443"]
- job name: "node"
    static_configs: 
      targets: ['localhost:9100']
```

This snippet:

* Puts Ansible Tower as the target to scrape data from.
* Sets a metric path to pull that scraped data.
* Defines the scrape interval.
 
</Collapser>
<Collapser

  id="nrql"
  title="Step 4. Build NRQL queries for metrics and logs"
>
With your data ingested and displaying in your dashboard, customize the dashboard based on your team's needs. New Relic dashboards are built and generated with NRQL queries.

To get this dashboard, for example:

<img
  title="Ansible Tower metrics dashboard"
  alt="A screenshot that shows a metrics dashboard"
  src={ansibleQueryMetrics}
/>

You would use this query:

```sql
FROM Metric SELECT count(status) FACET status SINCE 7 days ago WHERE prometheus_server = 'prometheus_remote' AND job = 'tower'
```

For a dashboard that shows your Ansible Tower logs, you might try:

```sql
FROM Log SELECT * WHERE logtype = 'ansible_tower_log'
```

This query generates this dashboard:

<img
  title="Ansible Tower logs dashboard"
  alt="A screenshot that shows a logs dashboard"
  src={ansibleLogsQuery}
/>

To view any of the queries behind your dashboards, click the three dots in the upper right of a dashboard. Click **View query**.

<img
  title="Ansible Tower logs dashboard"
  alt="A screenshot that shows a logs dashboard"
  src={ansibleViewQuery}
/>
</Collapser>
</CollapserGroup>

## What's next? [#next]

To learn more about building NRQL queries and generating dashboards, check out these docs:

* [Introduction to the query builder](/docs/query-your-data/explore-query-data/query-builder/introduction-query-builder) to create basic and advanced queries.
* [Introduction to dashboards](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards) to customize your dashboard and carry out different actions.
* [Manage your dashboard](/docs/query-your-data/explore-query-data/dashboards/manage-your-dashboard) to adjust your dashboards display mode, or to add more content to your dashboard. 