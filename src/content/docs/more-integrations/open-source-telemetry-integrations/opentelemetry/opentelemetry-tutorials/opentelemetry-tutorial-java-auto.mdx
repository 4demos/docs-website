---
title: 'OpenTelemetry tutorial: Auto-instrumentation of Java app'
tags:
  - Integrations
  - Open source telemetry integrations
  - OpenTelemetry
metaDescription: You can set up OpenTelemetry to monitor a simple Java app using auto-instrumentation.
---

OpenTelemetry Java provides an auto-instrumentation option that allows you to instrument your app with OpenTelemetry without modifying your source code. This approach is the simplest way to get started with the agent and see data in New Relic.


The auto-instrumentation agent is a Java agent JAR that dynamically injects bytecode to capture telemetry from popular libraries and frameworks; it can also be used to capture data such as inbound requests, outbound HTTP calls, and database calls. It can be attached to any Java 8+ application. 

<Callout variant="tip">
  See the [official documentation](https://opentelemetry.io/docs/instrumentation/java/automatic/) and our [auto-instrumentation example](https://github.com/newrelic/newrelic-opentelemetry-examples/tree/main/java/agent-nr-config)  for additional configuration options. 
</Callout>

## A. Download the software [#download]

Here's how to get the software you need for this tutorial:

1. Start by cloning the demo application, which generates the nth number in the Fibonacci sequence:

    ```
    git clone https://github.com/newrelic-experimental/REPO
    ```

2. Download the [agent JAR file](https://github.com/open-telemetry/opentelemetry-java-instrumentation/releases/latest/download/opentelemetry-javaagent.jar), which contains the agent and instrumentation libraries.

## B. Build the demo app [#build]

Navigate to the application's `java` directory and build the app with this command:

```
./gradlew
```

After a successful build, you will find the resulting application jar file in `java/build/libs`

## C. Export some environment variables [#export-env]

Export the following environment variables to configure the agent. Please note the details about each of them:

### Exporters [#exporters]

* Headers: Replace `YOUR_LICENSE_KEY` with your [ingest license key](https://docs.newrelic.com/docs/apis/intro-apis/new-relic-api-keys/#license-key).
    ```
    OTEL_EXPORTER_OTLP_HEADERS=api-key=<your_license_key>
    ```

* Endpoints: Export data to New Relic's OTLP endpoint.
    ```
    OTEL_EXPORTER_OTLP_ENDPOINT=https://otlp.nr-data.net:4317
    ```

### Service [#services]

* Name: Optionally replace with the name you wish to call your application.
    ```
    OTEL_SERVICE_NAME=INSERT_YOUR_SERIVCE_NAME_HERE
    ```
* Instance ID: Give this application a unique instance id.
    ```
    OTEL_RESOURCE_ATTRIBUTES=service.instance.id=1234
    ```
### Traces [#traces]

Attribute length: New relic disallows attributes whose length exceeds 4095 characters.
```
OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT=4095
```

### Metrics [#metrics]

* Temporality preference: New Relic supports metrics in delta temporality, instead of the default of cumulative.
    ```
    OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE=DELTA
    ```
* Histogram aggregation: Use exponential histogram instead of default explicit bucket histogram for better data compression.
    ```
    OTEL_EXPORTER_OTLP_METRICS_DEFAULT_HISTOGRAM_AGGREGATION=EXPONENTIAL_BUCKET_HISTOGRAM
    ```

### Logs [#logs-env]

Logs exporter: Enable log export over OTLP. Log export is disabled by default.
```
OTEL_LOGS_EXPORTER=otlp
```

### Additional recommended environment variables [#recommended-env]

* Compression: Gzip compression has good performance and lowers data egress.
    ```
    OTEL_EXPORTER_OTLP_COMPRESSION=gzip
    ```

* Retry: Enable experimental export retry to help cope with the unreliability of the internet.
    ```
    OTEL_EXPERIMENTAL_EXPORTER_OTLP_RETRY_ENABLED=true
    ```

* Resource attribute: Disable the `process.command_line` resource attribute which often exceeds the New Relic maximum attribute length limit.
    ```
    OTEL_EXPERIMENTAL_RESOURCE_DISABLED_KEYS=process.command_line
    ```

## Exercise the app to generate some traffic [#exercise]

You're ready to send some data to New Relic!

1. Launch the agent with your app from the `java` directory:
    ```
    java -javaagent:path/to/opentelemetry-javaagent.jar \
         -jar ./build/libs/fibonacci-java.jar
    ```
2. Generate traffic from the application by opening a new terminal in the `java` directory and running the load generator:
    ```
    ./load-generator.sh
    ```

## View your data in New Relic [#view-data]

You'll need to wait a few minutes for your telemetry data to show up in your New Relic account.

1. Go to **[one.newrelic.com](https://one.newrelic.com/all-capabilities) > APM & services**.
2. Click your entity (service).

For more details about viewing your data, see [OpenTelemetry in the New Relic UI](https://docs.newrelic.com/docs/more-integrations/open-source-telemetry-integrations/opentelemetry/view-your-data/opentelemetry-distributed-tracing-page)