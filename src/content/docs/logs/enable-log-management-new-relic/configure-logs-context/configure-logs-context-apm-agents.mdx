---
title: Configure logs in context with APM agents
tags:
  - Logs
  - Enable log management in New Relic
  - Configure logs in context
metaDescription: Link your log data with related data across the rest of the New Relic platform by configuring logs in context with APM extensions.
redirects:
  - /docs/enable-logs-context-logs
  - /docs/enable-apm-logs-context-logs
  - /docs/logs/new-relic-logs/enable-logs-context/enable-apm-logs-context-logs
  - /docs/logs/new-relic-logs/enable-logs-context/enable-logs-context-apm-agents
  - /node/36951
  - /docs/logs/enable-logs/configure-logs-context/configure-logs-context-apm-agents
  - /docs/logs/enable-log-monitoring-new-relic/configure-logs-context/configure-logs-context-apm-agents
  - /docs/logs/new-relic-logs/enable-logs-context
  - /docs/logs/new-relic-logs/apm-integration
  - /docs/logs/log-monitoring/apm-integration
  - /docs/logs/log-management/apm-integration
  - /docs/logs/new-relic-logs/enable-logs/2-configure-logs-context-apm-agents
  - /docs/logs/log-monitoring/enable-logs/configure-logs-context-apm-agents
---

When you need to correlate log data with other telemetry data, enable logs in context in New Relic. Logs in context adds metadata that links your logs with related APM data, like [errors](/docs/apm/apm-ui-pages/error-analytics/errors-page-find-fix-verify-problems/) or [distributed traces](/docs/apm/distributed-tracing/ui-data/understand-use-distributed-tracing-data), or your platform performance data from infrastructure monitoring in New Relic One.

## See the root cause of issues across your platform [#compatibility-requirements]

By bringing all of your application and infrastructure data together in a single solution, you can get to the root cause of issues faster. Logs in context help you quickly see meaningful patterns and trends.

Don't spend extra time trying to narrow down all your logs from different parts of your platform. Instead, enable logs in context to see the exact log lines you need to identify and resolve a problem.

## Basic process to enable logs in context [#enable-logs]

The process to enable logs in context is basically the same, regardless of which APM agent you use to monitor your application:

1. Update to a supported APM agent version for your app, and enable [distributed tracing](/docs/understand-dependencies/distributed-tracing/enable-configure/enable-distributed-tracing/).
2. Configure a [supported log forwarder](/docs/logs/enable-log-management-new-relic/enable-log-monitoring-new-relic/enable-log-management-new-relic/) to collect your application logs and extend the metadata that is forwarded to New Relic.
3. Configure logs in context for your APM agent, as explained in this document, or for your [infrastructure monitoring agent](/docs/logs/enable-log-management-new-relic/enable-log-monitoring-new-relic/forward-your-logs-using-infrastructure-agent/).
4. View your logs within the context of your apps or infrastructure in [New Relic One](/docs/logs/log-management/ui-data/use-logs-ui/#links).

The main differences in this procedure are which log appenders you can use to extend and enrich your log data, and how to configure the log appender you select for your APM agent.

## C SDK [#enable-c-sdk]

Logs in context is not available for apps monitored by the C SDK. Instead, you can build your own logging extension library by using the [Log API](/docs/logs/log-management/log-api/introduction-log-api/).

To [enable distributed tracing](/docs/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing/#update-agents) for apps monitored by the C SDK, [install](/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code/) or [update](/docs/agents/c-sdk/install-configure/update-your-c-sdk-library/) to the latest C SDK version. Use [C SDK version 1.1.0 or higher](/docs/release-notes/agent-release-notes/c-sdk-release-notes/) for distributed tracing.

## Go [#enable-go]

To enable logs in context for APM apps monitored by Go:

1. [Install](/docs/agents/go-agent/installation/install-new-relic-go/) or [update](/docs/agents/go-agent/installation/update-go-agent/) to the latest Go agent version, and [enable distributed tracing](/docs/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing/#update-agents). Use [Go agent version 2.12 or higher](/docs/release-notes/agent-release-notes/go-release-notes/) for logs in context.
2. Configure a [supported log forwarder](/docs/logs/enable-log-management-new-relic/enable-log-monitoring-new-relic/enable-log-management-new-relic/) to collect your application logs and extend the metadata that is forwarded to New Relic with logs in context.
3. Install the [Logrus logging framework version 1.4.0 or higher](https://github.com/sirupsen/logrus) to enrich your log data.
4. Configure logs in context for Go using the Logrus extension.

<CollapserGroup>
  <Collapser
    id="go-configure"
    title="Go configuration with Logrus"
  >

1. Import the following packages in files where Logrus is configured:

   ```
   import (
       log "github.com/sirupsen/logrus"
       "github.com/newrelic/go-agent/v3/integrations/logcontext/nrlogrusplugin"
       "github.com/newrelic/go-agent/v3/newrelic"
   )
   ```
2. Set the Logrus formatter to `nrlogrusplugin.ContextFormatter`:

   ```
   logger := log.New()
   logger.SetFormatter(nrlogrusplugin.ContextFormatter{})
   ```

   OR

   If you are using the Logrus standard logger:

   ```
   log.SetFormatter(nrlogrusplugin.ContextFormatter{})
   ```

   The logger will now look for a `newrelic.Transaction` inside its context and decorate logs accordingly.
3. Update your standard logging call to include contextual logging, and pass this to the logger.

   For example, instead of `logger.Info("Hello New Relic!")`, use

   ```
   ctx := newrelic.NewContext(context.Background(), txn)
   logger.WithContext(ctx).Info("Hello New Relic!")
   ```

   where `txn` is the current running transaction.

  </Collapser>

</CollapserGroup>

4. To verify that you have configured the log appender correctly, run your application, then check your [logs data in New Relic One](/docs/logs/log-management/ui-data/use-logs-ui/) using the query operator `has:span.id has:trace.id`.

If everything is configured correctly and your data is being forwarded to New Relic with the enriched metadata, your logs should now be emitted as JSON and contain `trace.id` and `span.id` fields.

## Java [#enable-java]

To enable logs in context for APM apps monitored by Java:

1. [Install](/docs/agents/java-agent/installation/install-java-agent/) or [update](/docs/agents/java-agent/installation/update-java-agent/) to the latest Java agent version, and [enable distributed tracing](/docs/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing/#update-agents). Use [Java agent version 5.6.0 or higher](/docs/release-notes/agent-release-notes/java-release-notes/) for logs in context.
2. Configure a [supported log forwarder](/docs/logs/enable-log-management-new-relic/enable-log-monitoring-new-relic/enable-log-management-new-relic/) to collect your application logs and extend the metadata that is forwarded to New Relic with logs in context.
3. Install any of the following log appenders to enrich your log data:
    * Dropwizard 1.3 or higher
    * Log4j 1.x
    * Log4j 2.x
    * Logback 1.2.0 or higher
    * java.util.logging with classpath additions if necessary
   
   If you use Spring or Spring Boot and aren't sure which extension you need, see our [Spring documentation](/docs/logs/enable-log-management-new-relic/configure-logs-context-apm-agents/#java-spring).  
4. Configure logs in context for Java with your selected log extension.

<CollapserGroup>
  <Collapser
    id="java-dropwizard"
    title="Dropwizard"
  >
  You can use [Dropwizard](https://dropwizard.readthedocs.io/en/release-1.3.x/manual/core.html#logging) with your Java app to forward your log data with related data across the rest of the New Relic platform. The [code](https://github.com/newrelic/java-log-extensions/tree/main/dropwizard) and an [example application](https://github.com/newrelic/java-log-extensions/tree/main/examples/dropwizard-app) are available on GitHub.

1. Enable the JVM argument [JVM argument `-javaagent`](/docs/agents/java-agent/installation/include-java-agent-jvm-argument) on the Java agent.
2. Install the [Dropwizard 1.3 or higher](https://dropwizard.readthedocs.io/en/release-1.3.x/manual/core.html#logging) package on your application with the original Dropwizard appenders and logging factory.
3. Update your project's dependencies to include the Dropwizard 1.3 extension as applicable:

   * To update with Gradle, add the following to your `build.gradle` file:

     ```
     dependencies {
         compile("com.newrelic.logging:dropwizard:2.0")
     }
     ```
   * To update with Maven, add the following to your `pom.xml` file:

     ```
     <dependencies>
         <dependency>
             <groupId>com.newrelic.logging</groupId>
             <artifactId>dropwizard</artifactId>
             <version>2.0</version>
         </dependency>
     </dependencies>
     ```
4. Update your Dropwizard `.yaml` configuration file with a `newrelic-json` layout, replacing the currently used `type: console` or `type: file` with either `type: newrelic-console` or `type: newrelic-file` as appropriate. For example:

   ```
   logging:
     appenders:
       - <var>type: newrelic-console</var>
         # Add the two lines below if you don't have a layout specified on the appender.
         # If you have a layout, remove all parameters to the layout and set the type.
         layout: 
           <var>type: newrelic-json</var>
   ```

   Alternatively, the New Relic Dropwizard extension also supports a `log-format` layout type that uses the standard Dropwizard logging. For testing purposes, you can change the type of the layout with a one-line change:

   ```
   logging:
     appenders:
       - type: newrelic-file
         # This format will be ignored by the newrelic-json layout, but used by the log-format layout.
         logFormat: "%date{ISO8601} %c %-5p: %m trace.id=%mdc{trace.id} span.id=%mdc{span.id}%n"
         layout: 
           # type: newrelic-json
           type: log-format
   ```

  </Collapser>

  <Collapser
    id="java-util-logging"
    title="java.util.logging"
  >

To configure logs in context with the [`java.util.logging` package](https://docs.oracle.com/javase/7/docs/api/java/util/logging/package-summary.html):

1. Update your project's dependencies to include the `java.util.logging` extension as applicable:

   * Gradle: Add the following to your `build.gradle` file:

     ```
     dependencies {
         compile("com.newrelic.logging:jul:2.0")
     }
     ```
   * Maven: Add the following to your `pom.xml` file:

     ```
     <dependencies>
         <dependency>
             <groupId>com.newrelic.logging</groupId>
             <artifactId>jul</artifactId>
             <version>2.0</version>
         </dependency>
     </dependencies>
     ```

     If you can't edit these files, you can instead [add the jars directly to the application classpath](/docs/logs/enable-new-relic-logs/logs-context-java/java-adding-classpath/).
     
2. Check if your logging file's `handlers` property is set to something other than `NewRelicMemoryHandler`. Look for a line listing the root logger's handlers, like this:

   ```
   handlers = java.util.logging.FileHandler
   ```
3. Update your logging properties file to set the root logger's handler to `NewRelicMemoryHandler` so it intercepts messages destined for another handler:

   ```
   handlers = com.newrelic.logging.jul.NewRelicMemoryHandler
   ```
4. Configure the `NewRelicMemoryHandler` by setting the target to the handler that was previously assigned to the root logger, so it captures data New Relic needs on the thread the log message is coming from:

   ```
   com.newrelic.logging.jul.NewRelicMemoryHandler.target = java.util.logging.FileHandler
   ```

5. Use a `NewRelicFormatter` for the final handler. Update your logging properties file to set the `formatter` property like the following example. Make sure the handler where you set the formatter is the `target` handler from the previous step (`java.util.logging.FileHandler` in this example).

   ```
   java.util.logging.FileHandler.formatter = com.newrelic.logging.jul.NewRelicFormatter
   ```

     The New Relic log format is a tailored JSON format with specific fields in specific places that our log forwarder plugins and back end rely on. At this time, we don't support any customization of that format.

     Once complete, JSON is logged instead of text. The JSON should be formatted as single objects, one per line, and should contain fields like `log.level` and `thread.name`. The `trace.id`, which is required for logs in context, should only have a value for log messages that occur within a transaction.

  </Collapser>

  <Collapser
    id="java-util-logging"
    title="java.util.logging classpath additions"
  >

  The most direct way to get the logs in context extensions with the [`java.util.logging` package](https://docs.oracle.com/javase/7/docs/api/java/util/logging/package-summary.html) is to add the dependencies to Maven's `pom.xml` or Gradle's `build.gradle`. This allows the packaging tools pick up the correct dependencies. If you are unable to modify the application and repackage it, you can still set up logs in context by making some additions to your `classpath`.

  Before you modify the classpath:

    * Make sure the [JVM argument `-javaagent`](/docs/agents/java-agent/installation/include-java-agent-jvm-argument/) is enabled on your app's Java agent.
    * You must know the logging framework the application is using.
    * You must be able to change your logging framework's configuration.

Add the following three jars to the classpath if they aren't already present. Generally, we recommend taking the latest versions published on Maven Central.

* Group ID `com.newrelic.logging` and Artifact ID: Select the artifact named after [your application's logging framework in Maven](https://search.maven.org/search?q=g:com.newrelic.logging).
* Group ID `com.fasterxml.jackson.core` and Artifact ID: Use [`jackson-core`](https://search.maven.org/search?q=g:com.fasterxml.jackson.core%20a:jackson-core).
* Group ID `com.newrelic.agent.java` and Artifact ID: Use [`newrelic-api`](https://search.maven.org/search?q=g:com.newrelic.agent.java%20a:newrelic-api).

  </Collapser>

  <Collapser
    id="java-log4j-1x"
    title="Log4j 1.x"
  >

  To configure logs in context with the Log4j 1.x extension for your Java app:

1. Update your project's dependencies to include the Log4j 1.x extension as applicable:

   * To update with Gradle, add the following to your `build.gradle` file:

     ```
     dependencies {
       compile("com.newrelic.logging:log4j1:2.0")
     }
     ```
   * To update with Maven, add the following to your `pom.xml` file:

     ```
     <dependencies>
       <dependency>
         <groupId>com.newrelic.logging</groupId>
         <artifactId>log4j1</artifactId>
         <version>2.0</version>
       </dependency>
     </dependencies>
     ```
2. In your logging configuration XML file, update your `<appender>` element with a `NewRelicLayout`, adding `<layout class="com.newrelic.logging.log4j1.NewRelicLayout"/>` as shown below:

   ```
   <appender name="<mark>TypicalFile</mark>" class="org.apache.log4j.FileAppender">
     <param name="file" value="logs/log4j1-app.log"/>
     <param name="append" value="false"/>
     <layout class="<mark>com.newrelic.logging.log4j1.NewRelicLayout</mark>"/> <!-- only this line needs to be added -->
   </appender>
   ```
3. Use `NewRelicAsyncAppender` to wrap any appenders that will target New Relic's log forwarder. For example:

   ```
   <appender name="<mark>NewRelicFile</mark>" 
             class="com.newrelic.logging.log4j1.NewRelicAsyncAppender">
     <appender-ref ref="<mark>TypicalFile</mark>" />
   </appender>
   ```
4. Use the async appender on the root logger. For example:

   ```
   <root>
       <appender-ref ref="<mark>NewRelicFile</mark>" />
   </root>
   ```

**Example configuration file for the Log4j 1.x extension:**

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration debug="false">
    <appender name="TypicalFile" class="org.apache.log4j.FileAppender">
        <param name="file" value="logs/log4j1-app.log"/>
        <param name="append" value="false"/>
        <mark><!-- layout has been replaced --></mark>
        <mark><layout class="com.newrelic.logging.log4j1.NewRelicLayout"/></mark>
    </appender>

<mark>    <!-- this appender was added -->
    <appender name="NewRelicFile" 
              class="com.newrelic.logging.log4j1.NewRelicAsyncAppender">
        <appender-ref ref="TypicalFile" />
    </appender></mark>

    <appender name="TypicalConsole" class="org.apache.log4j.ConsoleAppender">
      <layout class="org.apache.log4j.PatternLayout"> 
        <param name="ConversionPattern" value="%-5p %c{1} - %m%n"/> 
       </layout> 
    </appender>

    <root>        ​
        <mark><!-- the new appender was used here -->​​</mark>
        <mark><appender-ref ref="NewRelicFile" /></mark>
        <appender-ref ref="TypicalConsole" />
    </root>

</log4j:configuration>
```

  </Collapser>

  <Collapser
    id="java-log4j-2x"
    title="Log4j 2.x"
  >

  To configure logs in context with the Log4j 2.x extension for your Java app:

1. Update your project's dependencies to include the Log4j 2.x extension as applicable:

   To update with Gradle, add the highlighted section to your `build.gradle` file:

   ```
   dependencies {
       <mark>compile("com.newrelic.logging:log4j2:2.0")</mark>
   }
   ```

   To update with Maven, add the highlighted section to your `pom.xml` file:

   ```
   <dependencies>
   <mark>    <dependency>
           <groupId>com.newrelic.logging</groupId>
           <artifactId>log4j2</artifactId>
           <version>2.0</version>
       </dependency></mark>
   </dependencies>
   ```
2. In your logging configuration XML file, update your `<configuration>` element by adding the highlighted section:

  ```
  <Configuration xmlns="http://logging.apache.org/log4j/2.0/config"
        <mark>packages="com.newrelic.logging.log4j2"</mark>
  >
  ```

  If you are using a properties file, add `packages=com.newrelic.logging.log4j2`.

3. Add `<NewRelicLayout/>` to use a `NewRelicLayout` element within one of the appenders. For example:

   ```
   <File name="MyFile" fileName="logs/app-log-file.log">
       <mark><NewRelicLayout/></mark>
   </File>
   ```

   If you are using a properties file, change only the `layout.type`:

   ```
   appender.console.type = Console
   appender.console.name = STDOUT
   <mark>appender.console.layout.type = NewRelicLayout</mark>
   ```
4. If you only modified an existing appender, skip this step. If you added a new appender:

   Add `<AppenderRef/>` within `<Root>` to use this appender. The `ref` attribute refers to the `name` of the appender you created in the previous step. For example:

   ```
   <Root level="info">
       <mark><AppenderRef ref="MyFile"/></mark>
   </Root>
   ```

   If you are using a properties file and added a new appender, add:

   ```
   rootLogger.level = info
   <mark>rootLogger.appenderRef.stdout.ref = STDOUT</mark>​​​​​
   ```

  </Collapser>

  <Collapser
    id="java-logback"
    title="Logback"
  >

  To configure logs in context with the Logback extension for your Java app:

1. Update your project's dependencies to include the Logback extension as applicable:

   * To update with **Gradle**, add the following to your `build.gradle` file:

     ```
     dependencies {
       compile("com.newrelic.logging:logback:2.0")
     }
     ```
   * To update with **Maven**, add the following to your `pom.xml` file:

     ```
     <dependencies>
         <dependency>
             <groupId>com.newrelic.logging</groupId>
             <artifactId>logback</artifactId>
             <version>2.0</version>
         </dependency>
     </dependencies>
     ```
2. Update your logging configuration xml to replace any existing `<encoder>` element:

   If you are logging to the console (stdout/stderr), look for `ConsoleAppender` and replace:

   ```
   <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
       <encoder class="com.newrelic.logging.logback.NewRelicEncoder"/>
   </appender>
   ```

   If you are logging to a file, look for `FileAppender` and replace `<encoder>`:

   ```
   <appender name="LOG_FILE" class="ch.qos.logback.core.FileAppender">
       <file>logs/app-log-file.log</file>
       <encoder class="com.newrelic.logging.logback.NewRelicEncoder"/>
   </appender>
   ```
3. Update your logging configuration xml with the `NewRelicAsyncAppender`. To ensure that `NewRelicAsyncAppender` wraps any appenders that will target New Relic's log forwarder, add the following section. Change `"LOG_FILE"` to the name of the appender you updated in the previous step.

   ```
   <appender name="ASYNC" class="com.newrelic.logging.logback.NewRelicAsyncAppender">
       <appender-ref ref="LOG_FILE" />
   </appender>
   ```
4. Make sure `NewRelicAsyncAppender` is the **first** appender used in your logger, then list any other appenders after the `NewRelicAsyncAppender` in the `<root>` list. Replace your root logger’s appenders with the `ASYNC` appender created in the previous step.

   ```
   <root>
       <appender-ref ref="ASYNC" />
   </root>
   ```

**Example configuration file:**

   You can find a [working example in GitHub](https://github.com/newrelic/java-log-extensions/blob/master/examples/logback-app/src/main/resources/logback.xml). Here are examples of an updated logging .xml file for the Logback extension.

    ```
    <configuration>
      <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">

        <!-- changed the encoder -->
        <encoder class="com.newrelic.logging.logback.NewRelicEncoder"/>

      </appender>

      <!-- added the ASYNC appender -->
      <appender name="ASYNC" class="com.newrelic.logging.logback.NewRelicAsyncAppender">
        <appender-ref ref="STDOUT" />
      </appender>

      <root level="debug">

        <!-- changed the root logger -->
        <appender-ref ref="ASYNC" /> 

      </root>
    </configuration>
    ```

  </Collapser>

  <Collapser
    id="java-spring"
    title="Spring and Spring Boot"
  >

We offer extensions for your Java app that are compatible with current versions of [Spring](https://spring.io/) and [Spring Boot](https://spring.io/projects/spring-boot).

**Configure with Spring Boot:**

The extensions support default configurations only on Spring Boot 2.0 or higher. Here are tips to determine which logging library you have:

* If you have `spring-boot-starter-log4j2` in your dependencies, you're using **log4j 2.x**. Refer to the [Spring Boot log4j 2.x documentation](https://docs.spring.io/spring-boot/docs/current/reference/html/howto.html#howto-configure-log4j-for-logging) for basic configuration, and the [New Relic log4j 2 extension](/#java-log4j-2x) to customize your configuration for logs in New Relic.
* If you're using Spring Boot but **not** the `starter-log4j2`, you're using **logback** by default. Refer to [Spring Boot logback documentation](https://docs.spring.io/spring-boot/docs/current/reference/html/howto.html#howto-configure-logback-for-logging) for basic configuration, and the [New Relic logback extension](/#java-logback) to customize your configuration for logs in New Relic.

**Configure with Spring 5 or higher:**

Spring implements a [bridge](https://docs.spring.io/spring/docs/current/javadoc-api/org/apache/commons/logging/LogFactory.html) to other logging libraries that will automatically find them. However, those individual libraries must be configured and explicitly included in your project dependencies.

To identify your logging dependency, review your [Gradle](https://docs.gradle.org/current/userguide/viewing_debugging_dependencies.html), [Maven](https://maven.apache.org/plugins/maven-dependency-plugin/examples/resolving-conflicts-using-the-dependency-tree.html), or other build tool's dependency tree. Then follow the procedures in this document for your individual library page to configure logs in context for your Java app.

**Configure with Spring 4 or lower:**

Spring versions 4 and earlier use [Apache Commons Logging](https://commons.apache.org/proper/commons-logging/guide.html) for their bridge. Refer to the [Spring documentation](https://docs.spring.io/spring/docs/4.3.12.RELEASE/spring-framework-reference/html/overview.html#overview-logging) for information on configuring the bridge.

  </Collapser>

  </CollapserGroup>

  5. To verify that you have configured the log appender correctly, run your application, then check your [logs data in New Relic One](/docs/logs/log-management/ui-data/use-logs-ui/) using the query operator `has:span.id has:trace.id`.

If everything is configured correctly and your data is being forwarded to New Relic with enriched metadata, your logs should now be emitted as JSON and contain `trace.id` and `span.id` fields.

## .NET [#enable-net]

To enable logs in context for APM apps monitored by .NET:

1. Make sure your .NET agent supports logs in context and has [distributed tracing enabled](/docs/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing/). Version requirements:

   * [New Relic .NET agent 8.21 or higher](https://docs.newrelic.com/docs/release-notes/agent-release-notes/net-release-notes)
   * [New Relic .NET agent API 8.21 or higher](https://docs.newrelic.com/docs/agents/net-agent/net-agent-api)
   * Microsoft [.NET Framework 4.5 or higher](https://dotnet.microsoft.com/download/dotnet-framework)
   * Microsoft [.NET Core 2.0 or higher](https://dotnet.microsoft.com/download/dotnet-core)
2. Configure logs in context for .NET for your logging extension:

<CollapserGroup>
  <Collapser
    id="log4net"
    title=".NET configuration with log4net"
  >
  Use the [Apache log4net](https://logging.apache.org/log4net/) extension to link to your log data with related data across the rest of the New Relic platform. Log4net uses `appender` and `layout` to store and format log messages. The [`NewRelicAppender`](https://github.com/newrelic/newrelic-logenricher-dotnet/tree/master/src/Log4Net) enriches log messages with contextual information from the New Relic .NET agent if it is attached to your application. The appender passes enriched log messages to downstream appenders for specific use case log message handle.

  Log4net also provides [`NewRelicLayout`](https://github.com/newrelic/newrelic-logenricher-dotnet/tree/master/src/Log4Net) to output log messages in the format required by the New Relic logging endpoint. You can configure a target to write logging data to an output folder. The target can be monitored by a log forwarder to incrementally send log information to New Relic.

  For more information about logging with log4net, see the Apache log4net [Getting started](https://logging.apache.org/log4net/) documentation.

  To configure logs in context with the log4net extension:

  1. Make sure you are using [Log4net 2.0.8 or higher](https://logging.apache.org/log4net/).
  2. Using the Visual Studio [NuGet Package Manager](https://docs.microsoft.com/en-us/nuget/consume-packages/install-use-packages-visual-studio), locate and install the [`NewRelic.LogEnrichers.Log4Net`](https://www.nuget.org/packages/NewRelic.LogEnrichers.Log4Net/) package.
  3. In your log4net configuration file, update your logging configuration to use the `NewRelicAppender` as the first level appender, and reference your existing appenders as its children. Also replace the layout of the appender that writes log messages to an output destination with the `NewRelicLayout`.

  The following log4net configuration example enriches log events with New Relic linking metadata. In addition to the existing log files, it outputs new log files in a specific JSON format at `C:\logs\log4netExample.log.json` for consumption by the log forwarder:

  ```
   <log4net>
     <root>
       <level value="ALL" />
       <appender-ref ref="NewRelicAppender" />
     </root>

     <appender name="NewRelicAppender" type="NewRelic.LogEnrichers.Log4Net.NewRelicAppender, NewRelic.LogEnrichers.Log4Net" >
       <threshold value="ALL"/>
       <appender-ref ref="FileAppender" />
     </appender>

     <appender name="FileAppender" type="log4net.Appender.FileAppender">
       <file value="C:\logs\log4netExample.log.json" />
       <param name="AppendToFile" value="true" />
       <layout type="NewRelic.LogEnrichers.Log4Net.NewRelicLayout, NewRelic.LogEnrichers.Log4Net">
       </layout>
     </appender>
   </log4net>
   ```

   Once you have configured the log4net extension and updated your logging file, you can configure your extension to send log data to New Relic. Here is an example configuration:

   ```
   <!--NewRelicLoggingExample.conf-->
   <source> 
       @type tail 
       path C:\logs\log4netExample.log.json
       pos_file C:\logs\log4netExample.log.json.pos 
       tag logfile.*
    <parse> 
       @type json 
   </parse>
   </source>
   <match **> 
       @type newrelic 
       license_key <YOUR NEW_RELIC_LICENSE_KEY>
       base_uri https://log-api.newrelic.com/log/v1
   </match>
   ```

  </Collapser>
  <Collapser
    id="NLog"
    title=".NET configuration with NLog"
  >

  NLog works by having [layouts](https://github.com/NLog/NLog/wiki/Tutorial#Layouts-and-LayoutRenderers) (which guide what data is added to log events and in what format) and [targets](https://github.com/NLog/NLog/wiki/Tutorial#target-wrappers) (which control where logging data is sent.)
  
  The [New Relic NLog extension](https://github.com/newrelic/newrelic-logenricher-dotnet) provides a `NewRelicJsonLayout` which formats a log event in the way required by the New Relic logging endpoint, and adds contextual information from the .NET agent when attached to your application. You can then configure a target to write logging data to an output folder, which can be monitored by a log forwarder to incrementally send log information to New Relic.

  To configure logs in context with the NLog extension:

  1. Make sure you are using [NLog 4.5 or higher](https://nlog-project.org/).
  2. Using the Visual Studio [NuGet Package Manager](https://docs.microsoft.com/en-us/nuget/consume-packages/install-use-packages-visual-studio), locate and install the [`NewRelic.LogEnrichers.NLog`](https://www.nuget.org/packages/NewRelic.LogEnrichers.NLog/) package.
  3. In your application code, update your logging configuration to add the `NewRelicJsonLayout` and decide if you want to collect MappedDiagnosticsContext (**MDC**) or the MappedDiagnosticsLogicalContext (**MDLC**) data.

  The following configuration examples result in new JSON files that are written to disk. Some of these [configuration options](https://github.com/nlog/NLog/wiki/File-target) may be useful in managing the amount of disk space used and/or the performance of the target.

     * `archiveAboveSize`
     * `maxArchiveFiles`
     * `bufferSize`
     * `enableArchiveFileCompression`
     * `autoFlush`
     * `concurrentWrites`

  Though not required, using the [NLog AsyncWrapper Target](https://github.com/nlog/NLog/wiki/AsyncWrapper-target) may help improve the performance by performing formatting and output of log files on a different thread.

  **Example: Don't collect MDC or the MDLC data (default)**  
   The following code example enriches log events with New Relic linking metadata, but not with MDC or the MDLC data. In addition to the existing log files, it outputs new log files in a specific JSON format at `C:\logs\NLogExample.log.json` for consumption by the log forwarder:

   ```
   var loggerConfig = new LoggingConfiguration();
   var newRelicFileTarget = new FileTarget("NewRelicFileTarget");
   newRelicFileTarget.Layout = new NewRelicJsonLayout();
   newRelicFileTarget.FileName = "C:\logs\NLogExample.json";
   loggerConfig.AddTarget(newRelicFileTarget);
   loggerConfig.AddRuleForAllLevels("NewRelicFileTarget");
   LogManager.Configuration = loggerConfig;
   var logger = LogManager.GetLogger("Example");
   ```

   **Example: Collect MDC or the MDLC data**  
   If your application uses the MDC or the MDLC, you can configure the `NewRelicJsonLayout` to include items in those collections. The following code example adds the additional configuration to enable collecting MDC and MDLC data.  As in the previous example, it outputs new log files in a specific JSON format at `C:\logs\NLogExample.log.json` for consumption by the log forwarder:

   ```
   var loggerConfig = new LoggingConfiguration();
   var newRelicFileTarget = new FileTarget("NewRelicFileTarget");
   var newRelicLayout = new NewRelicJsonLayout
   {
       IncludeMdc = true,
       IncludeMdlc = true
   };

   newRelicFileTarget.Layout = newRelicLayout;
   newRelicFileTarget.FileName = "C:\logs\NLogExample.json";
   loggerConfig.AddTarget(newRelicFileTarget);
   loggerConfig.AddRuleForAllLevels("NewRelicFileTarget");
   LogManager.Configuration = loggerConfig;
   var logger = LogManager.GetLogger("Example");
   ```
Once you have configured the NLog extension and updated your logging file, you can configure your extension to send data to New Relic. Here is an example configuration:

   ```
   <!--NewRelicLoggingExample.conf-->
   <source> 
       @type tail 
       path C:\logs\NLogExample.log.json
       pos_file C:\logs\NLogExample.log.json.pos 
       tag logfile.*
    <parse> 
       @type json 
   </parse>
   </source>
   <match **> 
       @type newrelic 
       license_key <YOUR NEW_RELIC_LICENSE_KEY>
       base_uri https://log-api.newrelic.com/log/v1
   </match>
   ```

You can also configure the NLog extension with file-based configuration providers. The following example code creates a logger based on settings contained in an `App.config` file.

    **Instantiating Logger using `.config` file**

    ```
    var logger = LogManager.GetLogger("NewRelicLog");
    logger.Info("Hello, New Relic!");
    ```

    **Sample `App.config` file**

    ```
    <?xml version="1.0" encoding="utf-8" ?>
    <configuration>
      <configSections>
        <section name="nlog" type="NLog.Config.ConfigSectionHandler, NLog"/>
      </configSections>
      <startup>
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
      </startup>
      <nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <extensions>
          <add assembly="NewRelic.LogEnrichers.NLog" />
        </extensions>
        <targets>
          <target name="NewRelicLogFile" xsi:type="File" fileName="C:/path/to/NewRelicLog.json">
            <layout xsi:type="newrelic-jsonlayout">
            </layout>
          </target>
        </targets>
        <rules>
          <logger name="NewRelicLog" minlevel="Info" writeTo="newRelicLogFile" />
        </rules>
      </nlog>
    </configuration>
    ```
  </Collapser>
  <Collapser
    id="Serilog"
    title=".NET configuration with Serilog">

    [Serilog](https://serilog.net/) is a structured logging framework that records log messages from your application and creates a `LogEvent` to store the message data. Using [Enrichers](https://github.com/serilog/serilog/wiki/Enrichment), you can add additional information to the log events. You can also use [Sinks](https://github.com/serilog/serilog/wiki/Provided-Sinks) and [Formatters](https://github.com/serilog/serilog/wiki/Formatting-Output) to format and output the log events for downstream consumption and viewing.

  To configure logs in context with the Serilog extension:

  1. Make sure you are using [Serilog 2.5 or higher](https://serilog.net/) and [Serilog File Sinks v4.0 or higher](https://www.nuget.org/packages/Serilog.Sinks.File/).
  2. Using the Visual Studio [NuGet Package Manager](https://docs.microsoft.com/en-us/nuget/consume-packages/install-use-packages-visual-studio), locate and install the [`NewRelic.LogEnrichers.Serilog`](https://www.nuget.org/packages/NewRelic.LogEnrichers.Serilog) package.
  3. In your application code, update your logging configuration to add the `NewRelicEnricher` and `NewRelicFormatter`.

  The following configuration results in new JSON files that are written to disk. Some of these [configuration options](https://github.com/serilog/serilog-sinks-file) may be useful in managing the amount of disk space used and/or the performance of the sink.

     * `restrictedToMinimumLevel`
     * `buffered`
     * `rollingInterval`
     * `rollOnFileSizeLimit`
     * `retainedFileCountLimit`

  Though not required, using the [Serilog Asynchronous Sink Wrapper](https://www.nuget.org/packages/Serilog.Sinks.Async) may help improve the performance by performing formatting and output of log files on a different thread.

 The following code example enriches log events with New Relic linking metadata. In addition to the existing log files, it outputs new log files in a specific JSON format at `C:\logs\SerilogExample.log.json` for consumption by the log forwarder:

   ```
   var loggerConfig = new LoggerConfiguration()
           
    loggerConfig
       .Enrich.WithThreadName()
       .Enrich.WithThreadId()    
       .Enrich.WithNewRelicLogsInContext()
       .WriteTo.File( path: @"C:\logs\ExistingLoggingOutput.txt")
       .WriteTo.File(
           formatter: new NewRelicFormatter(), 
           path: @"C:\logs\SerilogExample.log.json");

    var log = loggerConfig.CreateLogger();
   ```


Once you have configured the Serilog extension and updated your logging file, you can configure your extension to send data to New Relic. Here is an example configuration:

   ```
   <!--NewRelicLoggingExample.conf-->
   <source> 
       @type tail 
       path C:\logs\SerilogExample.log.json
       pos_file C:\logs\SerilogExample.log.json.pos 
       tag logfile.*
    <parse> 
       @type json 
   </parse>
   </source>
   <match **> 
       @type newrelic 
       license_key <YOUR NEW_RELIC_LICENSE_KEY>
       base_uri https://log-api.newrelic.com/log/v1
   </match>
   ```

You can also configure the Serilog extension with file-based configuration providers. The following example code creates a logger based on settings contained in an `appSettings.json` file.

    <Callout variant="important">
      The following additional NuGet Packages are required:

      * [Microsoft.Extensions.Configuration](https://www.nuget.org/packages/Microsoft.Extensions.Configuration/)
      * [Serilog.Settings.Configuration](https://www.nuget.org/packages/Serilog.Settings.Configuration)
    </Callout>

    **Instantiating Logger using `appsettings.json`**

    ```
    var builder = new ConfigurationBuilder()
            .AddJsonFile("appsettings.json");
        
    var configuration = builder.Build();

    var logger = new LoggerConfiguration()
            .ReadFrom.Configuration(configuration)
            .CreateLogger();
    ```

    **Sample `appsettings.json` file**

    ```
    {
      "Serilog": {
        "Using": [ 
              "Serilog.Sinks.Console",
              "Serilog.Sinks.File",
              "NewRelic.LogEnrichers.Serilog" 
        ],
        "MinimumLevel": "Debug",
        "Enrich": [ "WithNewRelicLogsInContext" ],
        "WriteTo": [
          {
            "Name": "File",
            "Args": {
              "path": "C:\\Logs\\SerilogExample.log.json",
              "formatter": "NewRelic.LogEnrichers.Serilog.NewRelicFormatter, NewRelic.LogEnrichers.Serilog"
              }
          }
        ],
    
        "Properties": {
          "Application": "NewRelic Logging Serilog Example"
        }
      }
    }
    ```
  
    The following example code creates a logger based on settings contained in a `web.config` file.

    <Callout variant="important">
      The [Serilog.Settings.AppSettings](https://www.nuget.org/packages/Serilog.Settings.AppSettings) NuGet Package is required.
    </Callout>

    **Instantiating Logger using `.config` file**

    ```
    var logger = new LoggerConfiguration()
        .ReadFrom.AppSettings()
        .CreateLogger();
    ```

    **Sample `web.config` file**

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <configuration>
      <appSettings>
        <add key="serilog:using:NewRelic" value="NewRelic.LogEnrichers.Serilog" />
        <add key="serilog:using:File" value="Serilog.Sinks.File" />
        <!--Add other enrichers here-->
        <add key="serilog:enrich:WithNewRelicLogsInContext" />
        <add key="serilog:write-to:File.path" value="C:\logs\SerilogExample.log.json" />
        <add key="serilog:write-to:File.formatter" value="NewRelic.LogEnrichers.Serilog.NewRelicFormatter, NewRelic.LogEnrichers.Serilog" />
      </appSettings>
    ```
  </Collapser>
  </CollapserGroup>

  4. To verify that you have configured the log forwarder extension correctly, run your application and verify that the logging you have configured contains the following:

     * Includes `trace.id` and `span.id` fields
     * Has properly-formatted JSON lines

If everything is configured correctly and your data is being reported, you should see data in the [New Relic Logs UI](/docs/logs/log-management/ui-data/use-logs-ui/) using the query operator `has:span.id has:trace.id`.

## Node.js [#enable-nodejs]

To enable logs in context for APM apps monitored by Node.js:

1. Make sure your Node.js agent supports logs in context (agent version 1.4.0 or higher) and has [distributed tracing enabled](/docs/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing/).
2. Install the [Winston](https://github.com/winstonjs/winston) version 3.0.0 or higher.
3. Configure logs in context for Node.js using the Winston extension.

<CollapserGroup>
  <Collapser
    id="nodejs-configure"
    title="Node.js configuration with Winston"
  >

1. To install the New Relic Winston log enricher, enter the following command into your terminal or command line interface:

   ```
   npm install @newrelic/winston-enricher
   ```
2. In your application code, update your logging configuration to add the `newrelicFormatter`:

   ```
   // index.js
   require('newrelic')
   const newrelicFormatter = require('@newrelic/winston-enricher')
   ```

   The New Relic formatter can be used individually or combined with other formatters as the final format.

   ```
   format: winston.format.combine(
     winston.format.label({label: 'test'}),
     newrelicFormatter()
   )
   ```

  </Collapser>

</CollapserGroup>

4. To verify that you have configured the log forwarder extension correctly, run your application and verify that the logging you have configured contains the following:

   * Includes `trace.id` and `span.id` fields
   * Has properly-formatted JSON lines

If everything is configured correctly and your data is being reported, you should see data in the [New Relic Logs UI](/docs/logs/log-management/ui-data/use-logs-ui/) using the query operator `has:span.id has:trace.id`.

## PHP [#enable-php]

To enable logs in context for APM apps monitored by PHP:

1. Make sure your PHP agent supports logs in context (agent version 9.13.0.270 or higher) and has [distributed tracing enabled](/docs/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing/).
2. Install [Monolog](https://github.com/Seldaek/monolog) version 1 or 2, or use a compatible log forwarding plugin if you are not using the built-in Monolog Handler for New Relic.
3. Configure logs in context for PHP using the Monolog extension, if used.

<CollapserGroup>
  <Collapser
    id="php-configure"
    title="PHP configuration with Monolog"
  >

You must install the Monolog log enricher package before you can configure Monolog for New Relic logs in context. This is done by using Composer to install the [`newrelic/monolog-enricher`](https://packagist.org/packages/newrelic/monolog-enricher) package.

In most cases, use the `Processor` and `Handler` classes provided by the log enricher package in conjunction with Monolog's built-in `BufferHandler`.

  * The `Processor` adds the contextual metadata required for New Relic logs in context to operate.
  * The `Handler` sends the log records to New Relic Logs.
  * The `BufferHandler` ensures that the logs are delivered with as little overhead as possible.

At the point where you create the `Monolog\Logger` object, add the following `pushProcessor` and `pushHandler` calls to add the `Processor` and `Handler`:

```
<?php

use Monolog\Handler\BufferHandler;
use Monolog\Logger;
use NewRelic\Monolog\Enricher\{Handler, Processor};

$log = new Logger('log');
$log->pushProcessor(new Processor);
$log->pushHandler(new BufferHandler(new Handler));
```

<Callout variant="tip">
  You can use the `Processor` and `Handler` in conjunction with any existing Monolog setup. You do not need to remove your existing processors and handlers.
</Callout>

  </Collapser>
  <Collapser
    id="php-advanced"
    title="PHP configuration with other log forwarders"
  >

If you use Monolog to send logs to a compatible log forwarder, and you have already configured that tool to send logs to New Relic, you can use the `Processor` and `Formatter` solely for that tool. This option prevents additional overhead of sending logs directly to New Relic with the `Handler`.

You will need to be using a handler that supports the `setFormatter()` method, and your logging tool must be able to ingest JSON logs.

Here is an example of configuring Monolog to handle other log forwarders:

```
<?php

use Monolog\Handler\StreamHandler;
use Monolog\Logger;
use NewRelic\Monolog\Enricher\{Formatter, Processor};

$log = new Logger('log');
$log->pushProcessor(new Processor);

$handler = new StreamHandler('php://stderr');
$handler->setFormatter(new Formatter);
$log->pushHandler($handler);
```
  </Collapser>

</CollapserGroup>

4. To verify that you have configured the log forwarder extension correctly, run your application and verify that the logging you have configured contains the following:

   * Includes `trace.id` and `span.id` fields
   * Has properly-formatted JSON lines

If everything is configured correctly and your data is being reported, you should see data in the [New Relic Logs UI](/docs/logs/log-management/ui-data/use-logs-ui/) using the query operator `has:span.id has:trace.id`.

If the logs from your application do not include fields like `trace.id` and `span.id`, there may be a problem with the configuration of the Monolog log enricher. In this situation, check that:

* The application is using the Monolog logger object when sending log records, not `syslog()`.
* The PHP agent has been [installed](/docs/agents/php-agent/installation/php-agent-installation-overview) and is configured to [enable distributed tracing](/docs/understand-dependencies/distributed-tracing/enable-configure/enable-distributed-tracing).
* Another Monolog handler is not preventing the log record from [bubbling](https://github.com/Seldaek/monolog/blob/master/doc/01-usage.md#core-concepts).

## Python [#enable-python]

To enable logs in context for APM apps monitored by Python:

1. Make sure your Python agent supports logs in context (agent version 5.4.0 or higher) and has [distributed tracing enabled](/docs/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing/).
2. Configure the Python logging framework to use the `NewRelicContextFormatter`.

<CollapserGroup>
  <Collapser
    id="python-configure"
    title="Python configuration"
  >

Enabling logs in Python is as simple as instantiating a log formatter and adding it to your log handler. The following example uses a `StreamHandler` which by default writes logs to `sys.stderr`, but you can use any handler. For more information about configuring log handlers, see the [Python.org documentation](https://docs.python.org/3/library/logging.handlers.html).

```
# Import the logging module and the New Relic log formatter
import logging
from newrelic.agent import NewRelicContextFormatter

# Instantiate a new log handler
handler = logging.StreamHandler()

# Instantiate the log formatter and add it to the log handler
formatter = NewRelicContextFormatter()
handler.setFormatter(formatter)

# Get the root logger and add the handler to it
root_logger = logging.getLogger()
root_logger.addHandler(handler)
```
  </Collapser>

</CollapserGroup>

3. To verify that you have configured the log forwarder extension correctly, run your application and verify that the logging you have configured contains the following:

   * Includes `trace.id` and `span.id` fields
   * Has properly-formatted JSON lines

If everything is configured correctly and your data is being reported, you should see data in the [New Relic Logs UI](/docs/logs/log-management/ui-data/use-logs-ui/) using the query operator `has:span.id has:trace.id`.

## Ruby [#enable-ruby]

To enable logs in context for APM apps monitored by Ruby:

1. Make sure your Ruby agent supports logs in context (agent version 6.7.0 or higher) and has [distributed tracing enabled](/docs/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing/).
2. If applicable, make sure you are using a [supported Rails version](/docs/agents/ruby-agent/getting-started/ruby-agent-requirements-supported-frameworks#web_frameworks).
3. Configure logs in context for Ruby.

<CollapserGroup>
  <Collapser
    id="ruby-rails-configure"
    title="Rails configuration"
  >

Rails logging is controlled by two components:

 * A logger that is customizable by setting `config.logger`
 * A log formatter that is customizable by setting `config.log_formatter`
 
In most cases, you can configure logs in context by setting `config.log_formatter` to the `DecoratingFormatter` in your Rails application. For more information about Rails configuration, see the [rubyonrails.org documentation](https://guides.rubyonrails.org/configuring.html).

In your application's config, require `'newrelic_rpm'`, then add the following line:

```
module ________
  class Application < Rails::Application

    ...

    config.log_formatter = ::NewRelic::Agent::Logging::DecoratingFormatter.new
  end
end
```

This will use the New Relic log forwarder to format log messages, but the rest of the logging configuration will be provided by the other Rails config settings.

  </Collapser>

  <Collapser
    id="ruby-other-logger"
    title="Replacing the Rails logger"
  >

If setting the `log_formatter` option doesn't meet your needs, replace the entire Rails logger with an instance of the New Relic logger. Provide the parameters to the logger's constructor, like this:

```
module ________
  class Application < Rails::Application

    ...

    config.logger = ::NewRelic::Agent::Logging::DecoratingLogger.new(
      "log/application.log", #etc...
    )
  end
end
``` 
  </Collapser>

  <Collapser
    id="ruby-non-rails-configuration"
    title="Non-Rails configuration"
  >

For non-Rails applications, use the `DecoratingLogger` in place of the Ruby standard `::Logger`, like this:

```
logger = ::NewRelic::Agent::Logging::DecoratingLogger.new(
  'log/application.log', #etc...
)
...
  
logger.info(...)
```

The `DecoratingLogger` is a drop-in replacement for the Ruby standard `::Logger`. Their constructors accept the same parameters.
  </Collapser>

  <Collapser
    id="ruby-lograge-configuration"
    title="Lograge configuration"
  >

To configure our logging extension with the [lograge gem](https://rubygems.org/gems/lograge), there no additional configuration is required.
  </Collapser>

  <Collapser
    id="ruby-advanced-configuration"
    title="Other loggers configuration"
  >

To use our logging extension with a different logging implementation or with your own custom logger, use the `DecoratingFormatter`. For example:

```
module ________
  class Application < Rails::Application

    ...

    config.logger = ::YourCustomLoggerImplementation.new(
      $stdout,
      formatter: ::NewRelic::Agent::Logging::DecoratingFormatter.new
    )
  end
end
```
  </Collapser>

</CollapserGroup>

4. To verify that you have configured the log forwarder extension correctly, run your application and verify that the logging you have configured contains the following:

   * Includes `trace.id` and `span.id` fields
   * Has properly-formatted JSON lines

If everything is configured correctly and your data is being reported, you should see data in the [New Relic Logs UI](/docs/logs/log-management/ui-data/use-logs-ui/) using the query operator `has:span.id has:trace.id`.

Logs in context for Ruby does not support tagged logging. If you are initializing your logger with a `log_tags` argument, your custom tags may not appear on the final version of your logs.

## Agent API [#enable-api]

If you use a logging framework not covered by our existing logs-in-context solutions, you can use your APM agent API. This solution passes the linking metadata required to automatically correlate logs with errors and traces.

You can also build your own logging extension library for any language/logging framework by using the APM agent API or the [Log API](/docs/logs/log-management/log-api/introduction-log-api/).

## Troubleshooting [#troubleshooting]

Follow these troubleshooting steps as applicable.

<CollapserGroup>
  <Collapser
    id="missing-data"
    title="Log data is incomplete"
  >

  **Problem:** Not all log data in a message or for a specific attribute is being displayed.
  
  **Solution:** The stack trace will be written to the `error.stack` property. To accommodate New Relic's 4000-character log line limit, the stack and trace properties will be removed and the `message`, `error.message`, and `error.stack` values will be truncated to 1024 characters.

  </Collapser>

</CollapserGroup>

## What's next? [#what-next]

After you set up APM logs in context, make the most of your logging data:

* Explore the logging data across your platform with our [Logs UI](/docs/logs/log-management/ui-data/use-logs-ui/).
* See your logs in context of your app's performance in the [APM UI](/docs/logs/log-management/ui-data/use-logs-ui/#links). Troubleshoot [errors](/docs/apm/apm-ui-pages/error-analytics/errors-page-find-fix-verify-problems/) with [distributed tracing](/docs/apm/distributed-tracing/ui-data/understand-use-distributed-tracing-data), stack traces, application logs, and more.
* Get deeper visibility into both your application and your platform performance data by forwarding your logs with our [infrastructure monitoring agent](/docs/logs/enable-log-management-new-relic/enable-log-monitoring-new-relic/forward-your-logs-using-infrastructure-agent/). Review your [infrastructure logs](/docs/logs/log-management/ui-data/use-logs-ui/#links) in the UI.
* Set up [alerts](/docs/alerts-applied-intelligence/new-relic-alerts/alert-policies/create-edit-or-find-alert-policy/).
* [Query your data](/docs/query-your-data/explore-query-data/get-started/introduction-querying-new-relic-data/) and [create dashboards](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards/).
