---
title: Monitor your Xamarin app
tags:
    - Xamarin
    - Mobile monitoring
    - Hybrid framework
    - Get started
metaDescription: "New Relic's Xamarin agent for Android and iOS: Features, compatibility, requirements, installation, and upgrade procedures."
---

import mobileFlutterSummary from 'images/mobile_screenshot-full_flutter-summary.webp'

Monitor your Xamarin mobile application with our New Relic Xamarin agent. Capture C# errors, track specific network requests, use distributed tracing to drill down into handled exceptions, and create custom tracking events and metrics to fully capture your end users' experience.

<img
  title="Flutter summary view in the UI"
  alt="Summary view of a flutter app in New Relic"
  src={mobileFlutterSummary}
  style={{ maxWidth: '70%' }}
/>

<figcaption>
  **[one.newrelic.com](https://one.newrelic.com/all-capabilities) > Mobile > (select an app) > Summary**: View Xamarin data, track HTTP requests and errors, and monitor how your app is performing over time.
</figcaption>

Ready to get started? Follow the steps below! 

## Install the Xamarin agent
<Steps>

<Step>
### Review the requirements

Before you install the Xamarin agent, make sure your Xamarin app meets these version requirements:

* This plugin targets .NET standard 2.0 which means should also work with:
    * Xamarin.Android 8.0 and newer
    * Xamarin.iOS 10.14 and newer

* For Android-native apps:
    * Android API 24 or higher

* For iOS-native apps:
    * iOS 10
</Step>

<Step>
### Copy your application token [#app-token]

The application token is used for New Relic to authenticate your Flutter app's data. 

To view and copy your application token in the New Relic UI:

1. Go to **[one.newrelic.com](https://one.newrelic.com/all-capabilities)**, click **Add data**, then click **Mobile**.
2. Select your Xamarin app. 
3. Go to **Settings > Application** and copy the displayed **Application token**.

You'll add this application token in the next step.
</Step>

<Step>
### Add the Xamarin agent to `App.xaml.cs`

Add the agent package `NewRelic.Xamarin.Plugin` to your `App.xaml.cs`:

```C#
using NewRelic.Xamarin.Plugin;
...
    public App ()
    {
      InitializeComponent();

      MainPage = new MainPage();
      Application.Current.PageAppearing += OnPageAppearing;
      Application.Current.PageDisappearing += PageDisappearing;

      CrossNewRelicClient.Current.HandleUncaughtException();
      CrossNewRelicClient.Current.TrackShellNavigatedEvents()
      // Set optional agent configuration
      // Options are: crashReportingEnabled, loggingEnabled, logLevel, collectorAddress, crashCollectorAddress
      // AgentStartConfiguration agentConfig = new AgentStartConfiguration(true, true, LogLevel.INFO, "mobile-collector.newrelic.com", "mobile-crash.newrelic.com");
      if (Device.RuntimePlatform == Device.Android) 
      {
        CrossNewRelicClient.Current.Start("<APP-TOKEN-HERE>");
        // Start with optional agent configuration
        // CrossNewRelicClient.Current.Start("<APP-TOKEN-HERE>", agentConfig);
      } else if (Device.RuntimePlatform == Device.iOS)
      {
        CrossNewRelicClient.Current.Start("<APP-TOKEN-HERE>");
        // Start with optional agent configuration 
        // CrossNewRelicClient.Current.Start("<APP-TOKEN-HERE>", agentConfig);
      }
    }

```
Make sure you pasted your application token(s) (copied from [Step 3](#app-token)) into `<APP-TOKEN-HERE>` in the code above. If you're monitoring both Android-native and iOS-native apps, you'll need to add separate application tokens for each app.

</Step>

<Step>
### (Android-only) Add permissions

If you have an Android-native app, you'll need to add `INTERNET` and `ACCESS_NETWORK_STATE` permissions in your `Platforms/Android/AndroidManifest.xml` file:

```xml
	<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
	<uses-permission android:name="android.permission.INTERNET" />
```

And you're done! You should start seeing data in New Relic within 5 minutes.
</Step>

</Steps>

## View your Xamarin app data in New Relic

Now that you've got the Xamarin agent sending data to New Relic, it's time to view your app data in the UI.

Go to **[one.newrelic.com](https://one.newrelic.com/all-capabilities) > Mobile >** (select your Xamarin app) **> Summary** to see a summary of your data over time.

With the Xamarin agent, you have access to all mobile monitoring features, such as tracking crashes, HTTP requests, and handled exceptions. Check out these feature pages for more info:
* [Mobile app summary](/docs/mobile-monitoring/mobile-monitoring-ui/mobile-app-pages/mobile-apps-summary-page/#details)
* [Handled exceptions](/docs/mobile-monitoring/mobile-monitoring-ui/crashes/handled-exceptions-analyze-trends-prevent-crashes)
* [Crash event trails](/docs/mobile-monitoring/mobile-monitoring-ui/crashes/mobile-crash-event-trail)
* [HTTP requests](/docs/mobile-monitoring/mobile-monitoring-ui/network-pages/http-requests-page)
* [Set up alerts](/docs/mobile-monitoring/new-relic-mobile/get-started/mobile-monitoring-alert-information)

<Callout variant="tip" title="Troubleshoot missing data in the UI">

Having trouble finding HTTP data in the UI?

### Problem

After installing the agent and waiting at least 5 minutes, you see **No HTTP data appears:** on the **HTTP errors** and **HTTP requests** UI pages. 

### Solution

To instrument HTTP data, make sure to use the `HttpMessageHandler` in `HttpClient`.

</Callout>

## Query Flutter log data 

New Relic stores your Flutter logs as custom events. You can query these logs and build dashboards for them using this NRQL query:
```
 SELECT * FROM Mobile Dart Console Events SINCE 30 MINUTES AGO
```

For more information on NRQL queries, see [Introduction to NRQL](/docs/query-your-data/nrql-new-relic-query-language/get-started/introduction-nrql-new-relics-query-language/#where).

## Screen tracking events

The Xamarin mobile plugin allows you to track navigation events within the [Xamarin.Forms Shell](https://learn.microsoft.com/en-us/xamarin/xamarin-forms/app-fundamentals/shell/. In order to do so, you only need to call:

```C#
    CrossNewRelicClient.Current.TrackShellNavigatedEvents();
```

It is recommended to call this method along when starting the agent. These events will only be recorded after navigation is complete. You can find this data through the data explorer in `MobileBreadcrumb` under the name `ShellNavigated` or by query:

```sql
    SELECT * FROM MobileBreadcrumb WHERE name = 'ShellNavigated' SINCE 24 HOURS AGO
```

The breadcrumb will contain three attributes:
* `Current`: The URI of the current page.
* `Source`: The type of navigation that occurred.
* `Previous`: The URI of the previous page. Will not exist if previous page was null. 

## (Optional) Customize Xamarin agent instrumentation

Check out these optional API calls to further customize how the agent collects and reports data:

<CollapserGroup>
  <Collapser
    className="freq-link"
    id=""
    title="Track errors and resources"
  >
    Set up error tracking and resource tracking. 

    Because NewRelic Mobile Start calls `WidgetsFlutterBinding.ensureInitialized`, if you are not using NewRelic Mobile Start, you need to call this method prior to calling `NewrelicMobile.instance.startAgent`.

    ```dart
    if (Platform.isAndroid) {
        appToken = AppConfig.androidToken;
    } else if (Platform.isIOS) {
        appToken = AppConfig.iOSToken;
    }

    Config config = Config(
        accessToken: appToken,
        analyticsEventEnabled: true,
        networkErrorRequestEnabled: true,
        networkRequestEnabled: true,
        crashReportingEnabled: true,
        interactionTracingEnabled: true,
        httpResponseBodyCaptureEnabled: true,
        loggingEnabled: true,
        webViewInstrumentation: true,
        printStatementAsEventsEnabled: true,
        httpInstrumentationEnabled:true);

    // NewrelicMobile.instance.start(config, () {
    //   runApp(MyApp());
    // });

    runZonedGuarded(() async {
        WidgetsFlutterBinding.ensureInitialized();
        FlutterError.onError = NewrelicMobile.onError;
        await NewrelicMobile.instance.startAgent(config);
        runApp(MyApp());
    }, (Object error, StackTrace stackTrace) {
        NewrelicMobile.instance.recordError(error, stackTrace);
    });
    ```

    AppToken is platform specific. You need to generate separate tokens for Android and iOS apps.

    </Collapser>

  <Collapser
    className="freq-link"
    id=""
    title="Track screen navigation events"
  >

In order to track navigation events, you'll need to add the `NewRelicNavigationObserver` to your `MaterialApp`, `WidgetsApp`, or `CupertinoApp`.

```dart

import 'package:newrelic_mobile/newrelic_navigation_observer.dart';

//....

MaterialApp(
  navigatorObservers: [
    NewRelicNavigationObserver(),
  ],
  // other parameters
)
```

Add a name to `routes:` settings to help track each screen view/activity. Here's an example:

    ```dart
     Widget build(BuildContext context) {
    return MaterialApp(
      navigatorObservers: [NewRelicNavigationObserver()],
      routes: {
        'pageone': (context) => Page1Screen(),
        'pagetwo': (context) => Page2Screen(),
        'pagethree': (context) => Page3Screen(),
        'pagefour': (context) => Page4Screen()
      },
      theme: ThemeData(
        primarySwatch: Colors.blue,
        visualDensity: VisualDensity.adaptivePlatformDensity,
      ),
      initialRoute: 'pageone',
    );
  }
    ```

  </Collapser>

  <Collapser
    className="freq-link"
    id=""
    title="GoRouter: Enable automatic routing instrumentation"
  >

    When using the [go_router library](https://pub.dev/packages/go_router), you can enable the automatic routing instrumentation by adding an instance of `NewRelicNavigationObserver` to your application's `GoRouter.observers`:

    ```dart
    //....

    import 'package:go_router/go_router.dart';
    import 'package:newrelic_mobile/newrelic_navigation_observer.dart';


    final router = GoRouter(
        routes: ...,
            observers: [NewRelicNavigationObserver()],
    );
    ```

  </Collapser>

  <Collapser
    className="freq-link"
    id=""
    title="Manually report errors"
  >

    You can manually report non-fatal exceptions using custom attributes in the following method:

    ```dart
    try {
        some_code_that_throws_error();
    } catch (ex) {
    NewrelicMobile.instance
            .recordError(error, StackTrace.current, attributes: attributes);
    }
    ```

  </Collapser>

</CollapserGroup>

Use our [iOS SDK](/docs/mobile-monitoring/new-relic-mobile-ios/ios-sdk-api) or [Android SDK](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api) APIs to create custom events and metrics. Here are some examples:

<CollapserGroup>
    <Collapser
    className="freq-link"
    id="CrashNow"
    title="CrashNow"
    >

        **[CrashNow](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/crashnow-android-sdk-api/)(string message = "") : void;**

        Throws a demo run-time exception on Android/iOS to test New Relic crash reporting.

        ``` C#
    CrossNewRelicClient.Current.CrashNow();
```
    </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Create a session-level attribute"
    >
        **[setAttribute] (/docs/mobile-monitoring/new-relic-mobile-ios/ios-sdk-api)(String name, dynamic value) : void;**

        Creates a session-level attribute shared by multiple mobile event types. Overwrites its previous value and type each time it is called.

        ```dart
            NewrelicMobile.instance.setAttribute('RNCustomAttrNumber', 37);
        ```

    </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Retrieve ID of a current session"
    >
        **[CurrentSessionId](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/currentsessionid-android-sdk-api/)() : string;**

        Returns ID for the current session.

        ``` C#
    string sessionId = CrossNewRelicClient.Current.CurrentSessionId();
```

</Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Record a user interaction"
    >
        [StartInteraction](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/start-interaction)(string interactionName): string;

        Track a method as an interaction.

        [EndInteraction](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/end-interaction)(string interactionId): void;
        
        > End an interaction
> (Required). This uses the string ID for the interaction you want to end.
> This string is returned when you use startInteraction().

``` C#
    HttpClient myClient = new HttpClient(CrossNewRelicClient.Current.GetHttpMessageHandler());
    
    string interactionId = CrossNewRelicClient.Current.StartInteraction("Getting data from service");

    var response = await myClient.GetAsync(new Uri("https://jsonplaceholder.typicode.com/todos/1"));
    if (response.IsSuccessStatusCode)
    {
        var content = await response.Content.ReadAsStringAsync();
    } else
    {
        Console.WriteLine("Unsuccessful response code");
    }

    CrossNewRelicClient.Current.EndInteraction(interactionId);

```

</Collapser>

    <Collapser
    className="freq-link"
    id=""
    title=""
    >
        [NoticeHttpTransaction](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/notice-http-transaction/)(string url, string httpMethod, int statusCode, long startTime,long endTime, long bytesSent, long bytesReceived, string responseBody): void;

        Tracks network requests manually. You can use this method to record HTTP transactions, with an option to also send a response body.

        ``` C#
    CrossNewRelicClient.Current.NoticeHttpTransaction(
      "https://newrelic.com",
      "GET",
      200,
      DateTimeOffset.Now.ToUnixTimeMilliseconds(),
      DateTimeOffset.Now.ToUnixTimeMilliseconds() + 100,
      0,
      1000,
      ""
    );
```

</Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Record network failures"
    >
        [NoticeNetworkFailure](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/notice-network-failure/)(string url, string httpMethod, int statusCode, long startTime,long endTime, long bytesSent, long bytesReceived, string responseBody): void;

        Records network failures. If a network request fails, use this method to record details about the failure.

        > Records network failures. If a network request fails, use this method to record details about the failure.
``` C#
    CrossNewRelicClient.Current.NoticeNetworkFailure(
      "https://fakewebsite.com",
      "GET",
      DateTimeOffset.Now.ToUnixTimeMilliseconds(),
      DateTimeOffset.Now.ToUnixTimeMilliseconds() + 100,
      NetworkFailure.Unknown
    );
```

    </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title=""
    >
        [RecordBreadcrumb](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/recordbreadcrumb)(string name, Dictionary<string, object> attributes): bool;

        This call creates and records a MobileBreadcrumb event, which can be queried with NRQL and in the crash event trail.

        ``` C#
    CrossNewRelicClient.Current.RecordBreadcrumb("XamarinExampleBreadcrumb", new Dictionary<string, object>()
        {
            {"BreadNumValue", 12.3 },
            {"BreadStrValue", "XamBread" },
            {"BreadBoolValue", true }
        }
    );
```
    </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title=""
    >
        [RecordCustomEvent](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/recordcustomevent-android-sdk-api)(string eventType, string eventName, Dictionary<string, object> attributes): bool;

> Creates and records a custom event for use in New Relic Insights.

``` C#
    CrossNewRelicClient.Current.RecordCustomEvent("XamarinCustomEvent", "XamarinCustomEventCategory", new Dictionary<string, object>()
        {
            {"BreadNumValue", 12.3 },
            {"BreadStrValue", "XamBread" },
            {"BreadBoolValue", true }
        }
    );
```

</Collapser>

    <Collapser
    className="freq-link"
    id=""
    title=""
    >
        [RecordMetric](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/recordmetric-android-sdk-api/)(string name, string category) : void;
        
        [RecordMetric](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/recordmetric-android-sdk-api/)(string name, string category, double value) : void;

> Record custom metrics (arbitrary numerical data).

``` C#
    CrossNewRelicClient.Current.RecordMetric("Agent start", "Lifecycle");
    CrossNewRelicClient.Current.RecordMetric("Login Auth Metric", "Network", 78.9);
    CrossNewRelicClient.Current.RecordMetric("Request Metric", "Network", 20, MetricUnit.SECONDS, MetricUnit.OPERATIONS);
```


</Collapser>

    <Collapser
    className="freq-link"
    id=""
    title=""
    >
        [SetAttribute](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-attribute)(string name, string value) : bool;
### [SetAttribute](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-attribute)(string name, double value) : bool;
### [SetAttribute](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-attribute)(string name, bool value) : bool;

> Creates a session-level attribute shared by multiple mobile event types. Overwrites its previous value and type each time it is called.

``` C#
    CrossNewRelicClient.Current.SetAttribute("XamarinBoolAttr", false);
    CrossNewRelicClient.Current.SetAttribute("XamarinStrAttr", "Cat");
    CrossNewRelicClient.Current.SetAttribute("XamarinNumAttr", 13.5);
```

</Collapser>

    <Collapser
    className="freq-link"
    id=""
    title=""
    >
        [IncrementAttribute](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-attribute)(string name, float value = 1) : bool;

> Increments the count of an attriubte. Overwrites its previous value and type each time it is called.

``` C#
    // Increment by 1
    CrossNewRelicClient.Current.IncrementAttribute("XamarinNumAttr");
    // Increment by value
    CrossNewRelicClient.Current.IncrementAttribute("XamarinNumAttr", 12.3);
```

</Collapser>

 <Collapser
    className="freq-link"
    id=""
    title=""
    >
        ### [RemoveAttribute](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/remove-attribute)(string name) : bool;

> Removes an attribute.

``` C#
    CrossNewRelicClient.Current.RemoveAttribute("XamarinNumAttr");
```


### [RemoveAllAttributes](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/remove-all-attributes)() : bool;

> Removes all attributes from the session.

``` C#
    CrossNewRelicClient.Current.RemoveAllAttributes();
```

</Collapser>

 <Collapser
    className="freq-link"
    id=""
    title=""
    >
        [SetMaxEventBufferTime](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-max-event-buffer-time)(int maxBufferTimeInSec) void;

> Sets the event harvest cycle length.

  ``` C#
      CrossNewRelicClient.Current.SetMaxEventBufferTime(200);
  ```

</Collapser>

<Collapser
    id="INSERT_ID_HERE"
    title="INSERT_TITLE_HERE"
>
    [SetMaxEventPoolSize](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-max-event-pool-size)(int maxPoolSize): void;

> Sets the maximum size of the event pool.

  ``` C#
      CrossNewRelicClient.Current.SetMaxEventPoolSize(1500);
  ```
</Collapser>

<Collapser
    id="INSERT_ID_HERE"
    title="INSERT_TITLE_HERE"
>
    [SetUserId](https://docs.newrelic.com/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-user-id)(string userId): bool;

> Set a custom user identifier value to associate user sessions with analytics events and attributes.

``` C#
    CrossNewRelicClient.Current.SetUserId("User123");
```

</Collapser>

<Collapser
    id="INSERT_ID_HERE"
    title="INSERT_TITLE_HERE"
>
    GetHttpMessageHandler() : HttpMessageHandler;

> Provides a HttpMessageHandler to instrument http requests through HttpClient.

``` C#
    HttpClient myClient = new HttpClient(CrossNewRelicClient.Current.GetHttpMessageHandler());

    var response = await myClient.GetAsync(new Uri("https://jsonplaceholder.typicode.com/todos/1"));
    if (response.IsSuccessStatusCode)
    {
        var content = await response.Content.ReadAsStringAsync();
    } else
    {
        Console.WriteLine("Http request failed");
    }
```


</Collapser>

<Collapser
    id="INSERT_ID_HERE"
    title="INSERT_TITLE_HERE"
>
    AnalyticsEventEnabled(bool enabled) : void

> FOR ANDROID ONLY. Enable or disable collection of event data.

``` C#
    CrossNewRelicClient.Current.AnalyticsEventEnabled(true);
```
</Collapser>


<Collapser
    id="INSERT_ID_HERE"
    title="INSERT_TITLE_HERE"
>
    NetworkRequestEnabled(bool enabled) : void

> Enable or disable reporting successful HTTP requests to the MobileRequest event type.

``` C#
    CrossNewRelicClient.Current.NetworkRequestEnabled(true);
```
</Collapser>

<Collapser
    id="INSERT_ID_HERE"
    title="INSERT_TITLE_HERE"
>
    NetworkErrorRequestEnabled(bool enabled) : void

> Enable or disable reporting network and HTTP request errors to the MobileRequestError event type.

``` C#
    CrossNewRelicClient.Current.NetworkErrorRequestEnabled(true);
```
</Collapser>

<Collapser
    id="INSERT_ID_HERE"
    title="INSERT_TITLE_HERE"
>
    HttpResponseBodyCaptureEnabled(bool enabled) : void

> Enable or disable capture of HTTP response bodies for HTTP error traces, and MobileRequestError events.

``` C#
    CrossNewRelicClient.Current.HttpResponseBodyCaptureEnabled(true);
```
</Collapser>

<Collapser
    id="INSERT_ID_HERE"
    title="INSERT_TITLE_HERE"
>
    Shutdown() : void

> Shut down the agent within the current application lifecycle during runtime.
``` C#
    CrossNewRelicClient.Current.Shutdown());
</Collapser>

<Collapser
    id="INSERT_ID_HERE"
    title="Manually report errors"
>
    This plugin provides a handler to record unhandled exceptions to New Relic. It is recommended to initialize the handler prior to starting the agent.

### HandleUncaughtException(bool shouldThrowFormattedException = true) : void;

``` C#
    CrossNewRelicClient.Current.HandleUncaughtException();
    if (DeviceInfo.Current.Platform == DevicePlatform.Android) 
    {
        CrossNewRelicClient.Current.Start("<APP-TOKEN-HERE>");
    } else if (DeviceInfo.Current.Platform == DevicePlatform.iOS)
    {
        CrossNewRelicClient.Current.Start("<APP-TOKEN-HERE>");
    }
```

This plugin also provides a method to manually record any handled exceptions as well:
### RecordException(System.Exception exception) : void;

``` C#
    try {
      some_code_that_throws_error();
    } catch (Exception ex) {
      CrossNewRelicClient.Current.RecordException(ex);
    }
```
</Collapser>
</CollapserGroup>