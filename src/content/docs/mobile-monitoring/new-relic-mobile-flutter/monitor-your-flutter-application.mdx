---
title: Monitor your Flutter app
tags:
    - Flutter
    - Mobile monitoring
    - New Relic Mobile Flutter
    - Get started
metaDescription: "New Relic's Flutter agent for Android and iOS: Features, compatibility, requirements, installation, and upgrade procedures."
---


The New Relic Flutter agent monitors native applications (iOS, Android) built on the [Flutter framework](https://flutter.dev/). Written in JavaScript, the Cordova agent also includes all New Relic mobile monitoring features for native apps.

This agent allows you to instrument Flutter apps with help of native New Relic Android and iOS agents. The New Relic SDKs collect crashes, network traffic, and other information for hybrid apps using native components.

## Features

* Capture Dart errors
* Network Request tracking
* Distributed Tracing
* Future errors tracking
* Capture interactions and the sequence in which they were created
* Pass user information to New Relic to track user sessions
* Screen tracking via NavigationObserver
* Capture print and debug print statement as CustomEvents

## Review requirements

* Flutter 2.5 and higher.
* Dart 2.16.2 and higher, up to 2.9.9

For Android-native apps:
    * See [Android native requirements](/docs/mobile-monitoring/new-relic-mobile-android/get-started/n*ew-relic-android-compatibility-requirements)
    * Android API 24+

For iOS-native apps:
    * See [IOS native requirements](/docs/mobile-monitoring/new-relic-mobile-ios/get-started/new-relic-ios-compatibility-requirements)

## Step 1: Install the Flutter agent

First, you'll need to install the New Relic plugin into your dart project. In your `pubspec.yaml`, add the following to `dependencies`: 

```dart
dependencies:
    newrelic_mobile: 0.0.1-dev.10
```

## Step 2: Copy your application token #app-token

The application token is used for New Relic to authenticate your Flutter app's data. 

To view and copy your application token in the New Relic UI:

// Is it assumed they've already created an app in NR for their flutter app?

1. Go to **[one.newrelic.com](https://one.newrelic.com/all-capabilities)**, click **Add data**, then click **Mobile**.
2. Select your Flutter app. 
3. Go to **Settings > Application**, and copy the displayed **Application token**.

You'll add the token to configuration code in the next step. 

## Step 3: Configure your Flutter project

In your Flutter project, open `main.dart` and add the following code:

```dart
import 'package:newrelic_mobile/newrelic_mobile.dart';

    var appToken = "";

    if (Platform.isAndroid) {
        appToken = "<android app token>"; // Replace with your application token copied from the New Relic UI. 
    } else if (Platform.isIOS) {
        appToken = "<ios app token>"; // Replace with your application token copied from the New Relic UI. 
    }

    Config config =
        Config(accessToken: appToken,

        //Android Specific
        // Optional: Enable or disable collection of event data.
        analyticsEventEnabled: true,

        // Optional:Enable or disable reporting successful HTTP requests to the MobileRequest event type.
        networkErrorRequestEnabled: true,

        // Optional:Enable or disable reporting network and HTTP request errors to the MobileRequestError event type.
        networkRequestEnabled: true,

        // Optional:Enable or disable crash reporting.
        crashReportingEnabled: true,

        // Optional:Enable or disable interaction tracing. Trace instrumentation still occurs, but no traces are harvested. This will disable default and custom interactions.
        interactionTracingEnabled: true,

        // Optional: Enable or disable capture of HTTP response bodies for HTTP error traces and MobileRequestError events.
        httpResponseBodyCaptureEnabled: true,

        // Optional: Enable or disable agent logging.
        loggingEnabled: true,

        //iOS Specific
        // Optional: Enable or disable automatic instrumentation of WebViews
        webViewInstrumentation: true,

        //Optional: Enable or disable Print Statements as Analytics Events
        printStatementAsEventsEnabled : true,

        // Optional: Enable or disable automatic instrumentation of Http Request
        httpInstrumentationEnabled:true
        );

    NewrelicMobile.instance.start(config, () {
        runApp(MyApp());
    });

    class MyApp extends StatelessWidget {
    ....
```

Make sure you pasted your application token(s) copied from [Step 2](#app-token) into `appToken = ""` in the code above. If you're monitoring both an' Android-native and iOS-native app, you'll need to copy and paste tokens for both.

## (Android-only) Step 4: Configure your Android app

If you have an Android-native app, you'll need to finish the Flutter agent setup by configuring your Android app:

1. Add the following changes to your app's `android/build.gradle` file:

```dart
buildscript {
        ...
        repositories {
            ...
            mavenCentral()
        }
        dependencies {
            ...
            classpath "com.newrelic.agent.android:agent-gradle-plugin:6.9.2"
        }
    }
```
2. Apply the `newrelic` plugin to the top of your `android/app/build.gradle` file:

```dart
apply plugin: "com.android.application"
apply plugin: 'newrelic' // <-- add this
```

3. Add `INTERNET` and `ACCESS_NETWORK_STATE` permissions in your `AndroidManifest.xml` file:

```dart
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
```

And you're done! You should start seeing data in New Relic within 5 minutes. 

## What's next? 

Check out these optional API calls to further customize how New Relic collects and reports data: 

* Track errors and resources 
* Track screen navigation events
* GoRouter: Enable automatic routing instrumentation
* Manually report errors

### Track errors and resources

set up error tracking and resource tracking. Because NewRelic Mobile Start calls WidgetsFlutterBinding.ensureInitialized, if you are not using NewRelic Mobile Start, you need to call this method prior to calling NewrelicMobile.instance.startAgent.

```dart
if (Platform.isAndroid) {
    appToken = AppConfig.androidToken;
} else if (Platform.isIOS) {
    appToken = AppConfig.iOSToken;
}

Config config = Config(
    accessToken: appToken,
    analyticsEventEnabled: true,
    networkErrorRequestEnabled: true,
    networkRequestEnabled: true,
    crashReportingEnabled: true,
    interactionTracingEnabled: true,
    httpResponseBodyCaptureEnabled: true,
    loggingEnabled: true,
    webViewInstrumentation: true,
    printStatementAsEventsEnabled: true,
    httpInstrumentationEnabled:true);

// NewrelicMobile.instance.start(config, () {
//   runApp(MyApp());
// });

runZonedGuarded(() async {
    WidgetsFlutterBinding.ensureInitialized();
    FlutterError.onError = NewrelicMobile.onError;
    await NewrelicMobile.instance.startAgent(config);
    runApp(MyApp());
}, (Object error, StackTrace stackTrace) {
    NewrelicMobile.instance.recordError(error, stackTrace);
});
```

AppToken is platform-specific. You need to generate the seprate token for Android and iOS apps.

## Track screen navigation events

In order to track navigation events you have to add the NewRelicNavigationObserver to your MaterialApp, WidgetsApp or CupertinoApp.

You should provide a name to route settings: RouteSettings(name: 'Your Route Name'). The root route name / will be replaced by root "/" for clarity's sake.

```dart
import 'package:newrelic_mobile/newrelic_navigation_observer.dart';

//....

MaterialApp(
    navigatorObservers: [
        NewRelicNavigationObserver(),
    ],
    // other parameters
)
```

### GoRouter: Enable automatic routing instrumentation

When using the [go_router library](https://pub.dev/packages/go_router), the automatic routing instrumentation can be enabled by adding an instance of NewRelicNavigationObserver to your application's GoRouter.observers:

```dart
//....

import 'package:go_router/go_router.dart';
import 'package:newrelic_mobile/newrelic_navigation_observer.dart';


final router = GoRouter(
    routes: ...,
        observers: [NewRelicNavigationObserver()],
);
```
### Manually report errors

You can manually report non-fatal exceptions using custom attributes in the following method:

```dart
try {
    some_code_that_throws_error();
} catch (ex) {
NewrelicMobile.instance
        .recordError(error, StackTrace.current, attributes: attributes);
}
```

## Customize how data is reported

Here are some examples for how you can use APIs to customize how event data and metrics are measured:

r<CollapserGroup>
  <Collapser
    className="freq-link"
    id=""
    title="Android: Track a method as an interaction"
  >

### [startInteraction](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/start-interaction)(String actionName) Future<String>;

Track a method as an interaction.

`InteractionId` is string.

### [endInteraction](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/end-interaction)(String interactionId): void;

End an interaction.
(Required). This uses the string ID for the interaction you want to end.
This string is returned when you use startInteraction().

  ``` dart
            var id = await NewrelicMobile.instance.startInteraction("Getting Data from Service");
                try {
                  var dio = Dio();
                  var response = await dio.get(
                      'https://reqres.in/api/users?delay=15');
                     print(response);
                    NewrelicMobile.instance.endInteraction(id);
                    Timeline.finishSync();
                } catch (e) {
                  print(e);
                }
  
  ```
  </Collapser>

  <Collapser
    className="freq-link"
    id=""
    title="iOS: Creates a session-level attribute shared by multiple mobile event types"
  >
  ### [setAttribute] (/docs/mobile-monitoring/new-relic-mobile-ios/ios-sdk-api)(String name, dynamic value) : void;

Creates a session-level attribute shared by multiple mobile event types. Overwrites its previous value and type each time it is called.

  ```
      NewrelicMobile.instance.setAttribute('RNCustomAttrNumber', 37);
  ```

  </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Android: Connect user sessions with analytical events and attributes"
  >
  ### [setUserId](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-user-id)(String userId): void;

Set a custom user identifier value to associate user sessions with analytics events and attributes.

  ```
      NewrelicMobile.instance.setUserId("RN12934");
  ```

  </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Android: Record breadcrumbs"
  >
  ### [recordBreadcrumb](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/recordbreadcrumb)(String name,{Map<String, dynamic>? eventAttributes}): void;

Track app activity/screen that may be helpful for troubleshooting crashes.

  ``` dart
      NewrelicMobile.instance.recordBreadcrumb("Button Got Pressed on Screen 3"),
  ```

  </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Android: Record custom events"
  >
  ### [recordCustomEvent](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/recordcustomevent-android-sdk-api)(String eventType,{String eventName = "", Map<String, dynamic>? eventAttributes}): void;

Creates and records a custom event for use in New Relic Insights.

  ``` dart
      NewrelicMobile.instance.recordCustomEvent("Major",eventName: "User Purchase",eventAttributes: {"item1":"Clothes","price":34.00}),
            child: const Text('Record Custom Event'),
  ```
  </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Android: Configure max event buffer time"
  >
  ### [setMaxEventBufferTime](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-max-event-buffer-time)(int maxBufferTimeInSec) void;

Sets the event harvest cycle length.

  ``` dart
      NewrelicMobile.instance.setMaxEventBufferTime(200);
  ```
  </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Android: Configure the size of an event pool"
  >
  ### [setMaxEventPoolSize](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-max-event-pool-size)(int maxSize): void;

Sets the maximum size of the event pool.

  ``` dart
      NewrelicMobile.instance.setMaxEventPoolSize(10000);
  ```

  </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Android: Manually track network requests"
  >
  ### [noticeHttpTransaction](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/notice-http-transaction/)(String url,String httpMethod,int statusCode,int startTime,int endTime,int bytesSent,int bytesReceived,Map<String, dynamic>? traceData,{String responseBody = ""}): void;

Tracks network requests manually. You can use this method to record HTTP transactions, with an option to also send a response body.
 
 ``` dart
     NewrelicMobile.instance.noticeNetworkFailure("https://cb6b02be-a319-4de5-a3b1-361de2564493.mock.pstmn.io/searchpage", "GET", 1000, 2000,'Test Network Failure', NetworkFailure.dnsLookupFailed);
  ```

  </Collapser>

    <Collapser
    className="freq-link"
    id=""
    title="Android: Record network failures"
  >
  ### [noticeNetworkFailure](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/notice-network-failure/)(String url,String httpMethod,int startTime,int endTime,NetworkFailure errorCode): void;

Records network failures. If a network request fails, use this method to record details about the failures. In most cases, place this call inside exception handlers, such as catch blocks. Supported failures are: Unknown, BadURL, TimedOut, CannotConnectToHost, DNSLookupFailed, BadServerResponse, SecureConnectionFailed.

  ``` dart
     NewrelicMobile.instance.noticeNetworkFailure("https://cb6b02be-a319-4de5-a3b1-361de2564493.mock.pstmn.io/searchpage", "GET", 1000, 2000,'Test Network Failure', NetworkFailure.dnsLookupFailed);
  ```

  </Collapser>


</CollapserGroup>


## Next steps

Now that you've got the Flutter agent sending data to New Relic, it's time to view, track, and set up alerts for your Flutter app's performance.

// Which UI featurues do we want to highlight for  monitoring Flutter apps? i.e., distributed tracing, exceptions (event trails).
* Distributed tracing
* Exceptions (event trails)
* Capture Dart errors
* Network Request tracking
* Distributed Tracing
* Future errors tracking
* Capture interactions and the sequence in which they were created
* Pass user information to New Relic to track user sessions
* Screen tracking via NavigationObserver
* Capture print and debug print statement as CustomEvents


## Troubleshooting

Having trouble finding HTTP data in the UI? 

### Problem

After installing the Flutter agent and waiting at least 5 minutes, **No Http data appears:** in New Relic UI.

### Solution

If no http data appears after you wait at least five minutes, check you are not overriding HttpOverrides.global inside your flutter app.

