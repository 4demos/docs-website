---
componentType: default
optionType: deployment
headingText: Install the agent
descriptionText: Here's how to download and install the agent. 
---

## Download and install the agent [#msi]

Here are instructions for installing the agent. For instructions on installing the agent manually, or to see details on install options, see the command line instructions after this procedure.

1. Ensure you have admin rights for your Windows admin group. For more on this, see the [docs on permissions](/docs/agents/net-agent/getting-started/compatibility-requirements-net-framework-agent#user-rights).
2. Download the installer that matches your system architecture:
   * [64-bit](https://download.newrelic.com/dot_net_agent/latest_release/NewRelicDotNetAgent_x64.msi)
   * [32-bit](https://download.newrelic.com/dot_net_agent/latest_release/NewRelicDotNetAgent_x86.msi)
3. Run the install wizard. Tips for using the install wizard:
   * When prompted, input your [New Relic license key](/docs/apis/intro-apis/new-relic-api-keys/#ingest-license-key).
   * Consider leaving **Instrument all** disabled if you will only be monitoring applications hosted with IIS. Otherwise, enable **Instrument all** and follow additional instructions to [enable the agent for your application](#enabling-the-agent).
   * If you are changing an existing installation using the install wizard, select the **Change** option.
   * **Optional**: you can also [run the installer via the command line or from a script](#msi-command-line). This can be useful for automating your agent install.
4. For each application you wish to monitor, give it a meaningful name. For tips on setting the app name, see [Name your app](/docs/agents/net-agent/installation-and-configuration/naming-your-net-application).
5. If your application is short-lived (existing for less than 60 seconds), it will require [configuration](/docs/agents/net-agent/troubleshooting/monitor-short-lived-net-processes) or it won't report data.
6. Restart affected applications, and then restart IIS.

If your application is receiving traffic, data should appear within a few minutes. If it doesn't, see [No data appears](/docs/agents/net-agent/troubleshooting/no-data-appears-net).

<CollapserGroup>
  <Collapser
    id="manual"
    title="Optional: install via command line or script"
  >

Instead of using the MSI install wizard, described in the [standard install instructions](#msi), you can run the MSI from the command line or from a script. This can be useful for automating your agent install.

Here's the command to perform a new agent install using the MSI installer. (For changes to an existing installation, use the [`ADDLOCAL` command](#addlocal).) Replace the highlighted sections with relevant values.

```
msiexec.exe /i C:\<var>PATH_TO</var>\newrelic-agent-win-<var>x86</var>-VERSION.msi /qb NR_LICENSE_KEY=<var>YOUR_LICENSE_KEY</var> INSTALLLEVEL=<var>1</var>
```

The `INSTALLLEVEL` can be either `1` or `50`:

* `1`: Installs .NET agent with default options (described in table below). If your application is not hosted on IIS or uses IIS as a reverse proxy, you should use option `50`.
* `50`: Installs the agent with InstrumentAllNETFramework enabled (described below).

Instead of using the `INSTALLLEVEL` presets, you can customize which features to install with the `ADDLOCAL` command shown below. This is also the command you'd use to update an existing installation.

```
msiexec.exe /i C:\<var>PATH_TO</var>\newrelic-agent-win-<var>x86</var>-VERSION.msi /qb NR_LICENSE_KEY=<var>YOUR_LICENSE_KEY</var> ADDLOCAL=<var>OPTION_1, OPTION_2</var>
```

Available options are:

<table id="msi-command-line-options">
  <thead>
    <tr>
      <th width={300}>
        **Option**
      </th>

      <th>
        **Details**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `NETFrameworkSupport`
      </td>

      <td>
        Enabled by default. This identifies the registry keys used to attach the .NET profiler to a .NET Framework application. Without this, our .NET agent won't work for an IIS-hosted .NET Framework app.
      </td>
    </tr>

    <tr>
      <td>
        `NETCoreSupport`
      </td>

      <td>
        Enabled by default. This identifies the registry keys used to attach the .NET profiler to a .NET Core application. Without this, the .NET agent will not work for an IIS-hosted .NET Core app.
      </td>
    </tr>

    <tr>
      <td>
        `InstrumentAllNETFramework`
      </td>

      <td>
        This will result in all .NET Framework applications being instrumented by setting global environment variables. This setting is the equivalent of selecting **Instrument all** in the MSI install wizard.
      </td>
    </tr>

    <tr>
      <td>
        `StartMenuShortcuts`
      </td>

      <td>
        Enabled by default. Adds several useful shortcuts to your start menu.
      </td>
    </tr>

    <tr>
      <td>
        `ASPNETTools`
      </td>

      <td>
        Enabled by default. Adds the ASP.NET cache flush tool which, when run, clears out some .NET temporary files and restarts IIS.
      </td>
    </tr>
  </tbody>
</table>
</Collapser>
</CollapserGroup>